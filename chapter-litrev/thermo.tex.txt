% sort of motivation
Thermal-hydraulic calculations enable the correct design of \glspl{HTGR}.
The ability to predict the maximum fuel temperature at steady-state is of paramount importance to succeed in such task.
We emphasize this statement in the case hydrogen production is desirable.
Efficient hydrogen production requires higher coolant temperatures, which in turn increases the temperature of the fuel and the reactor pressure vessel.

% sort of intro to simplified models
The complex geometry of the hexagonal fuel assembly requires elaborate numerical calculations for obtaining accurate evaluations.
Thermal-hydraulic studies for early \glspl{HTGR} consisted mainly of support calculations for \gls{NRC} safety analysis reports.
The analyses employed sets of independent codes that relied on simplistic approximations.
Simplified models are helpful to understand some basic aspects of prismatic \glspl{HTGR} and have the advantage to reduce the computational expense of the calculations.

% shenoy_htgr_1974
General Atomics \cite{shenoy_htgr_1974} developed the first set of simplistic codes.
The following list introduces and summarizes some of these codes and their features:

\begin{itemize}
\item FLAC: It determines the coolant flow distribution in the coolant channels and gaps.
It solves the one-dimensional momentum equation for incompressible flow and the continuity equations for mass and energy.

\item POKE: It determines the coolant mass flow, coolant temperature, and fuel temperature distribution.
It solves the steady-state mass and momentum conservation equations for parallel channels.

\item DEMISE: It determines the steady-state three-dimensional temperature distribution in a standard element.
It solves the temperature in a network model.

\item TAC-2D: It is a general purpose two-dimensional thermal analysis code.
It solves the two-dimensional heat conduction equation.
\end{itemize}

Several studies have used these codes.
% macdonald_ngnp_2003
For example, \gls{INL} conducted in 2003 a design study \cite{macdonald_ngnp_2003} in support to the \gls{NGNP} project.
The objective of such study was to investigate options for the NGNP that increased the coolant temperature, with the lowest possible inlet temperature, and the highest overall core power.
The authors conducted several parametric studies whose reference reactor was the GT-MHR \cite{general_atomics_gas_1996}.
Using the code POKE, they evaluated two major design modifications: reducing the bypass flow and better controlling the inlet coolant flow distribution.
Reducing the bypass flow fraction from 20 to 10$\%$ reduces the peak fuel temperatures by about 50$^{\circ}$C.
Controlling the inlet flow distribution has a stronger effect.
Other studies focused on the dimensions of the reactor and their impact on the maximum fuel temperature.
Using the computer codes POKE and TAC2D, the authors investigated taller and higher power reactor cores.
The investigation included a 10-block-high 600 MWt, a 12-block-high 720 MWt, and 14-block-high 840 MWt.

Among the simplified approaches we differentiate the flow network model, the equivalent cylindrical model, and the unit cell model.
% flow network model
% reza_design_2006
Using the network analysis tool RELAP5-3D/ATHENA \cite{inl_relap5-3dathena_2005}, Reza et al. \cite{reza_design_2006} conducted a thermal hydraulic study of the GT-MHR.
Reza et al. increased the reactor outlet temperature to enable hydrogen production.
Additionally, they evaluated alternative coolant inflow paths in an attempt to reduce the reactor vessel temperatures.
After finding an optimal configuration, they evaluated the maximum temperatures in the fuel and the reactor vessel during the \gls{LPCC} and the \gls{HPCC} events.

% equivalent cylindrical model
% no_multi-component_2007
An example of codes using the equivalent cylindrical approach is GAMMA \cite{no_multi-component_2007}.
The code’s main objective is the modeling of the air ingress event following a LOCA.
Following the depressurization of helium in the core, there exists the potential for air to enter the core through the break and oxidize the in-core graphite structure.
The oxidation of graphite leads to exothermic chemical reactions and, thus, it is a major concern.
The GAMMA code solves heat conduction, fluid flow, chemical reactions, and multi-component molecular diffusion.
The code couples the solid and gas equations using the porous media model.
Together with the multi-dimensional analysis feature, GAMMA has a one-dimensional analysis capability for  modeling a flow network.

% takada_core_2004
Takada et al. \cite{takada_core_2004} carried out another study using the flow network and the equivalent cylindrical model.
Focusing on the \gls{HTTR}, they developed a thermal-hydraulic design code.
The code used the flow network analysis code FLOWNET \cite{maruyama_verification_1988} for calculating the coolant flow and temperature distributions.
The code TEMDIM \cite{maruyama_verification_1988} solved the fuel temperatures using the equivalent cylindrical model.
Finally, the authors validated the calculation scheme by comparing its results with the experimental data from the \gls{HTTR}.

% unit cell model
% nakano_conceptual_2008
Nakano et al. \cite{nakano_conceptual_2008} studied different fuel assembly configurations using several simplistic approximations.
For determining the fuel temperature, they used the TAC-2D code.
A previous nuclear analysis calculated the power density.
And a previous study calculated the flow distribution using the code FLOWNET.
The fuel temperature calculation used the equivalent cylindrical model for a hot channel unit cell.
However, the asymmetry of the unit cell configuration makes the temperature distribution asymmetric in the graphite block.
The equivalent cylindrical model fails to capture this behavior.

% in_three-dimensional_2006
In 2006, In et al. \cite{in_three-dimensional_2006} conducted a more detailed analysis using a three-dimensional model of the unit cell in the hot-spot of an \gls{HTGR}.
The objective of the study was to predict the maximum fuel temperature at steady-state.
The analysis focused on the GT-MHR 600 at \gls{EOC}.
The CFD code CFX 10 \cite{ansys_inc_cfx_2006} calculated the three-dimensional temperature profile.
In such a study, the results showed that the maximum fuel temperature surpassed the design limits and the authors propose a countermeasure accordingly.

% more detailed calculations
Such simplified approaches are helpful to understand some basic aspects of prismatic \glspl{HTGR} but they may affect the temperature distribution.
More detailed thermal-hydraulic evaluations were rare in the open literature until the last 15 years.

% cioni_3d_2005
Cioni et al. \cite{cioni_3d_2006} presented an article in 2005 in which they conducted three-dimensional simulations of fuel assemblies of an \gls{HTGR}.
The objective of the study was to investigate an emergency situation due to the blocking of cooling channels in the core.
They used the \gls{CFD} code Trio_U \cite{bieder_priceles_2000} to carry out the analysis.
The numerical scheme solved the three-dimensional conduction equation in the solid coupled to the one-dimensional thermal-hydraulic equations of the coolant.
In the preliminary work, the authors conducted a study of the influence of the bypass flow on the maximum coolant and fuel temperature.
Another preliminary study analyzed the consequences of two different blocking in a portion of a fuel assembly.
A central blockage exhibits a stronger influence over the maximum temperatures of the assembly compared to a peripheral blockage.
At last, they investigated two configurations.
First, six fuel elements surrounded the fuel element with the blockage.
Second, five fuel elements and one reflector element surrounded it.
The results suggested that the blockage increases the temperature on the blocked fuel assembly only and it does not affect the surrounding elements due to the bypass flow.
The results also showed that the fuel temperature surpassed the design limits, and that the reactor operators should counteract these effects with active systems.

% simoneau_three-dimensional_2007
Simoneau et al. \cite{simoneau_three-dimensional_2007} analyzed the transient behavior of an \gls{HTGR} during the \gls{DCC} and \gls{HPCC} event.
The CFD code STAR-CD \cite{computational_dynamics_limited_star-cd_2004} performed the calculations.
The code solved conductive, convective, and radiation heat transfer in a 30$^{\circ}$ section of the core and reactor vessel.
To accommodate the different spatial scales, the code uses the porous media model to represent the coolant flow and the prismatic fuel blocks.
The model does not resolve the boundary layer and the use of coefficients prescribe the solid-fluid heat transfer and pressure drop across the core.
The authors validated their model against explicit calculations using a single fuel block.
One of their results shows that the maximum temperature in the \gls{HPCC} event is lower than in the \gls{DCC} event.
However, the extra convective heat transfer causes a thermal stratification in the surrounding air, causing higher temperatures in the upper reactor structures.

% tak_numerical_2008
In 2008, an article by Tak et al. \cite{tak_numerical_2008} conducted  a three-dimensional \gls{CFD} analysis on a typical prismatic \gls{HTGR} fuel column.
The commercial code CFX 11 \cite{ansys_incorporated_cfx_2006} performed the calculations.
The fuel column under study was from the PMR-600, a pre-conceptual reactor that \gls{KAERI} has designed and whose reference design is the GT-MHR.
The study considered a one-twelfth section of the fuel due to its symmetry.
The model determined the coolant distribution using the one-dimensional thermal-hydraulic equations.
Such coolant distribution served as input to the CFD code.
Nevertheless, the friction in the channels is dependent on the viscosity which is highly dependent on the temperature.
Therefore, obtaining the mass flow rates from a separate solver may introduce errors \cite{sato_computational_2010}.
As mentioned earlier, the unit cell model may introduce errors in the maximum temperature prediction.
In order to asses the accuracy of the unit cell model, the authors compared the CFD results against the unit cell model results.
The unit cell model does not consider the bypass flow between assemblies or the radial power distribution within the fuel assembly.
Tak et al. conducted a parametric study which analyzed the impact of the bypass gap size on the maximum fuel temperature.
By increasing the bypass gap, the maximum fuel temperature grows.
The results of this study indicate that the accuracy of the unit cell worsens for larger gaps.
Another study imposed different radial peaking factors for the different fuel channels.
Such a study showed the effects of considering a non-flat radial power distribution.
The authors considered a radial power distribution that did not have a strong impact on the maximum fuel temperature.

% sato_computational_2010
Another article \cite{sato_computational_2010} carried out \gls{CFD} calculations of a typical prismatic \gls{HTGR} with the commercial code FLUENT \cite{fluent_inc_fluent_2006}.
Their model considered a one-twelfth section of the fuel column of the GT-MHR.
The authors conducted parametric studies changing several factors, such as bypass gap-width, turbulence model, axial heat generation profile, and geometry changes due to irradiation.
Their most relevant results show the presence of bypass flow causes a large lateral temperature gradient in the block.
Large temperature gradients cause excessive thermal stresses which raise potential structural issues.
The authors compared the results from different turbulence models: $k \sim \varepsilon$ and $k \sim \omega$.
The $k \sim \omega$ model predicted bulk temperatures that are considerably lower than those from the $k \sim \varepsilon$ model.
The differences went up to 49$^{\circ}$C.
The overall mass flow rate is about 10$\%$ greater for the $k \sim \omega$ model.
The study suggested that these turbulence models need more verification against prismatic \gls{HTGR} experiments.
Another study analyzed the effect of considering different peak radial factors.
Such consideration introduced variations of the maximum fuel temperature of up to 160 $^{\circ}$C.
Their last study focused on the effects of the graphite dimensional changes on the temperature profile.
The shrunk column showed considerably lower temperatures in the fuel.

% travis_thermalhydraulics_2013
In spite of the recent developments in CFD tools, a detailed full core explicit analysis for a prismatic \gls{HTGR} still requires a tremendous computational expense.
This requirement is mostly due to the three-dimensional CFD simulation of the coolant flow.
Travis et al. \cite{travis_thermalhydraulics_2013} developed a method to compute full core thermal-hydraulic analyses of \glspl{HTGR}.
The article presented a simplified method that reduces the computational time and memory requirements while maintaining accurate results.
The method solves the three-dimensional heat conduction in the solid and the one-dimensional thermal-hydraulic equations in the channels.
The fluid one-dimensional approximation avoids finer meshes near the walls as well as turbulence conservation equations \cite{tak_development_2014}.
The validation of the method analyzed a fuel column and compared the results to those of a three-dimensional CFD simulation.
The CFD simulation used the commercial software STAR-CCM+ \cite{cd-adapco_star-ccm_2012}.
The new computational scheme reduced the computation time to a 2.5\% of the time required by the three-dimensional CFD simulation.
The new method provided good predictions of the temperature distribution and the axial variation of the helium bulk temperature.
However, it failed to resolve properly the velocity and temperature distribution within the boundary layer.
Overall, the method showed good accuracy, and less than a 2\% difference to the three-dimensional CFD simulation.

% tak_practical_2012 / tak_development_2014
Tak et al. \cite{tak_practical_2012} \cite{tak_development_2014} developed CORONA, which uses a practical method for the whole core analysis.
The code intends to combine the accuracy from CFD tools and the light computational expense of system analysis codes.
The method solves the three-dimensional heat conduction equation in the solid and the one-dimensional thermal-hydraulic equations in the fluid.
In order to enhance practicability, the code adopts a basic unit cell concept, which eliminates an elaborate grid generation process.
The basic unit cell concept is an extension of the traditional unit cell method, which uses a single triangular unit cell.
This method considers various shapes of unit cells as well as the heat transfer between them.
The method provides a way for fast generating computational grids for modeling the solid regions.
To validate the new code, the authors compared the results using CORONA against the results using the commercial code CFX and experimental results.
The results of the verification and validation studies showed that the CORONA code provides reasonably accurate results.

% end of section
CFD techniques allow to compute the detailed temperature profile over local models.
The fine mesh requirement imposes high computational costs for a whole core CFD analysis, restricting the use of such methods.
However, a whole-core thermal analysis has many advantages over local models.
In general, the problem set up includes more accurate boundary conditions.
Without whole-core modeling, the mass flow distributions in local models are average values of the core flow rate instead of their exact value \cite{huning_novel_2016}.
This leads to under predicted fuel temperatures for the assemblies with a lower flow rate than the average.
Additionally, a coupled analysis with a reactor physics code requires a full core model \cite{tak_practical_2012}.

% this might appear in a summary of the chapter: see travis_thermalhydraulics_2013 / tak_practical_2012 / tak_development_2014 
% The fine mesh requirement for a whole core CFD analysis restricts the use of such methods.
% Most of the CFD studies limit their application to the local behavior of a fuel column.
% The alternative for an explicit whole-core analysis are system codes that use simplified models.
% However, the simplification of the geometries reduces the fuel block temperature resolution.
% The present method intends to overcome the difficulties in CFD calculation as well as in system calculations.
% The computational expense of a solid heat conduction equation is much less than that of fluid conservation equations in CFD analyses .
% This requirement is mostly due to the three-dimensional CFD simulation of the coolant flow.
% The methodology provides good predictions of the global parameters such as the three-dimensional spatial temperature distribution and the axial variation of the helium bulk temperature \cite{travis_thermalhydraulics_2013}.
% The fluid one-dimensional approximation avoids finer meshes near the walls as well as turbulence conservation equations \cite{tak_development_2014}.