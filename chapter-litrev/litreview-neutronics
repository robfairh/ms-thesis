%%%%%%%%%%%%%%%%%%%% Neutronics %%%%%%%%%%%%%%%%%%%

% wagner_three-dimensional_1989
The nodal methods developed for hexagonal geometry are similar to the analogous Cartesian geometry
nodal diffusion theory developed earlier at Siemens/KWU. %finnermann_new_1975 %finnemann_atomkernenergie_1977

The code HEXNOD calculates three-dimensional problems for fast reactors and high converter light water reactors.
It implements a nodal mehtod for solving the multigroup neutron diffusion equation.

They demonstrated the accuracy of nodal methods by comparison with the finite difference methods and Monte Carlo calculations for a number of benchmark problems.

They conclude that the code HEXNOD is well suited for 3D routine analysis of fast reactors.

Earlier heaxagonal nodal diffusion methods that apply the transverse integration procedure are based on the nodal expansion method (NEM).
In this paper they use an approximate analytic solution for the transverse-averaged group fluxes.

Nodal methods explanation:
The transverse integration procedure is used for deriving auxiliary one-dimensional diffusion equations.
In the case of a hexagonal prismatic node, this leads to a set of coupled one-dimensional equations for three spatial directions in the radial plane plus one equation for the axial direction.
These equations are then solved simultaneously.




% fitzpatrick_developments_1995
Introduces solution techniques for the time-dependence of the diffusion equations and couples it to spatial nodal algorithms.
The solution in 1D problems is compared against finite-difference solutions.




% ortensi_deterministic_2010-1
INL conducted a benchmark exercise based on modeling the High Temperature Test Reactor (HTTR).

26 energy group structure from IAEA benchmark.

Previous work on the HEXPEDITE methodology has tested the approach against other spatial discretizations for the neutron diffusion equation in hexagonal and triangular geometry, such as the nodal expansion method (NEM) and finite difference method (FDM). These studies have established HEXPEDITEâ€™s superiority in terms of accuracy and runtime over NEM and FDM.

Cross sections generated with DRAGON 4.
Cross sections used in the HEXPEDITE runs.

HEXPEDITE results for different critical configurations compared against MCNP5 and Serpent.
%Brown, F. B., et al., 2002, MCNP Version 5, LA-UR-02-3935, Los Alamos National Laboratory.

The results obtained with DRAGON-HEXPEDITE are compared against the results from other codes.
other codes: JAR (diffusion nodal), CITATION (diffusion FDM), CRONOS2 (diffusion-transport)
Results from the CRP-5 benchmark.

I say this: disadvantages of HEXPEDITE over FEM
A correction has to be applied to the multiplication factor.
HEXPEDITE cannnot accurately model the cylindrical periphery of the permanent reflector.

% for methods (tools):
One of the main issues with the generation of cross section in HTRs is the strong coupling between the blocks.
This strong coupling invalidates the assumption made in the lattice physics calculation (identical neighbors in an infinite domain).
In an ideal situation one would attempt to generate the cross sections from a 12th, 6th, or full core calculation that would consider all neighbor effects.




%lee_status_2006
* Energy Group Study:
HTGR analyses require more energy groups than conventional LWR analysis because the spectral interactions between fuels and fuel and reflector are significant due to a much longer neutron mean free path.
In this work, the number of energy groups versus accuracy has been studied using the one-dimensional fuel-reflector problem.

Fuel block cross sections are normally generated from a single fuel block calculation with reflective boundary condition, assuming that the spectrum of the single block configuration is not much different from the actual one in the core.
The effects of energy group structure on the accuracy of homogenized nodal cross sections were examined by changing the number of energy groups from 4 to 23 groups.
Cross sections were generates with DRAGON at 300 K.

One of their conclusions is that the number of energy groups should be more than 4, and 7 or more would be sufficient for uranium fueled HTGR.
The accuracy is sensitive to the energy group boundaries.

Table 12 shows results.

-----> To read: Some of this should go into the lit review when I mention the choice of method.

In parallel to developing a suite of codes based on the conventional two-step lattice and whole-core calculation approach, it is important to envision and develop analysis tools for the future.
These tools should eliminate the approximations inherent in the multi-step approach for whole-core analysis and be of higher accuracy and also less cumbersome to use.
These attributes indicate that the future codes be based on a spatially-heterogeneous capability that eliminates the various stages used in current state-of-the-art tools.
One obvious choice of a code would be that based on the stochastic Monte Carlo approach.
The Monte Carlo techniques provide detailed solution of the neutron transport problem in space, energy, and angle and could be applied with great accuracy to the VHTR if fuel particles are modeled explicitly in the core calculation.
The utilization of the Monte Carlo codes is however currently unattractive because of the tremendous problem size and the need for a large number of neutron histories required for resolution of fuel element power distribution and small reactivity effects.
Furthermore, several important phenomena such as thermal feedback at power generating conditions, flux uncertainty propagation in the depletion calculation and fission product build up are not properly addressed
in these tools at the current time.
In contrast, the direct three-dimensional whole-core transport calculation employing deterministic solution techniques provides a possibility for resolving all these problems as long as the double heterogeneity modeling capability is properly incorporated.

The DIF3D core solves the three-dimensional multigroup diffusion or transport equations for given core configurations.
It has several solution options such as the finite difference diffusion theory method (FDM), the nodal expansion diffusion theory method based on the transverse integration procedure, and the VARIANT nodal transport method.

% for conclusions
Moltres has a limited capability to represent the burnup dependency of cross sections.
The cross sections of VHTR fuel elements vary significantly with burnup and fuel and moderator temperatures.
Thus, a more general capability to represent the cross sections as a function of burnup and temperatures needs to be implemented.




%lewis_finite_1981
Discretization of the spatial variables of multi-dimensional neutron diffusion equation [4].
In this work, the author places their efforts on reducing the number of patial nodes required in the simulations.

The author applies the diffusion approximation with the finite element discretization to a variety of transport problem classes.

Concluding section with the limitations of the work to date and suggests possible future directions.

Ref 10-15




% kang_finite_1973




% yuk_time-dependent_2020
Reactor analysis tool should be capable of carrying out transient calculations for a reactivity insertion accident.
Time dependent neutron diffusion equation solved by the FEM.
Simplified thermal fluid analysis tool implemented to consider thermal feedback.
New method introduced to resolve control rod cusping effect without additional computation or mesh reconstruction.
These methods are applied to the reactor physiscs code CAPP.

The characteristics of a VHTR are different from those of conventional light water reactors.
This has led to the demand for a new reactor analysis tool.
Neutronics/thermal-fluid coupled analysis is also required due to the strong interaction between the temperature and the power in a VHTR core.
Benchmark problem based on the MHTGR350:
- ORTENSI et al. 2015
definition of the Benchamrk
- Strydom et al. 2016
PHISICS deterministic transport code coupled to RELAP5-3D
- Lemaire et al. 2017
Monte Carlo transport code MCS and GAMMA+

CAPP code for the reactor physics analysis of VHTRs
Lee et al. 2008, 2011, 2014
CAPP code performs a neutron diffusion calculation based on FEM
Becker et al. 1981
The code seeems to have its own thermal fluid analysis solver.
This paper expands upon ealier conference papers
Yuk et al 2018a, 2018b
and it extends the functionality of the CAPP code to the transient analysis.
Thermal fluid analysis code developed to consider the thermal feedback effect.
Reduction of the control rod cusping effec.

Control rod cusping effect:
Joo, 1984 % joo_resolution_1984

During the transient calculation with the control rod movements, partially rodded computation nodes (PRNs) usually appear.
The homogenization of PRNs is necessary for conventional diffusion nodal methods.
When the conservation of the reaction rates in PRNs is not considered, such homogenization induces a large error.

Various methods to reduce this effect:
- Flux volume weighted homogenization
- Homogeneous flux volume weighted homogenization
- Heterogeneous flux volume weighted homogenization
This methods require to solve the whole core problem repeatedly updated cross sections.

Mesh reconstruction is used to remove such partially rodded cases and removes the control rod cusping effect.
The reconstruction should be performed at each time step.


Reference:
VW: volume weighted homogenization
HFVW: Homogeneous flux volume weighted homogenization
However, this memethods solve the whole core problem with repeatedly updated cross sections.
The mesh reconstruction method removes the control rod cusping effect.
The method requires a mesh reconstruction at each time step.

The article introduces a method that integrates over partially rodded computation nodes (iPRN).
With this method, the control rod cusping effect cannot occur.

The article compares this methods taking the results from the mesh reconstruction method as the reference results.

I need to re read this.
...

Cross sections generated by DeCART2D.
This code system has different characteristics from those of the light
water reactors.
A prismatic VHTR has a large flux gradient.
Hence, a single assembly block calculation with the reflective boundary condition cannot give a reliable homogenized group constant set.
(I say this: Also that doesn't get the cross sections in the inner and outer reflectors.)

Due to the graphite, the resonance and up-scattering treatment are more important in a VHTR.
A conventional two energy group structure has limitations when it comes to handling such phenomena.

The authors recommend homogenizing the group constants using at least 10 energy groups.

Thermal-fluid analysis:
CAPP code has a simplified thermal fluid analysis solver
Lee et al. 2011

The geometry details are simplified in the analysis.
The unit of the thermal calculation is the triangular prism as in a neutron diffusion solver.
(The fuel assembly is represented by 6 triangles)
Each triangular prism has a representative coolant channel (Fig. 2)

Once the temperature in the coolant was calculated. then a 2D model calculates the temperature in the moderator and fuel.
It is necessary to know the temperature in the reflector due to the core/reflector spectrum interference effect.

After calculating the coolant temperature, a two-dimensional model calculates the temperature in the fuel and the moderator.

The model makes the assumption that all the energy produced in each prism contributes to the temperature rise of the coolant.
The boundary conditions of the 2D model are the coolant temperature at the hole.
The other surfaces are adiabatic.

The CAPP code uses predetermined 2-D tables of thermal conductivity for each material.
For a given fast neutron fluence and temperature, the code obtains the thermal conductivity by interpolation.

Transient calculations:
The variation of fluid temeprature during the transient calculation is rather small.
The equation for a coolant channel is then the same as that for a steady-state calculation.
Solid regions incorporate the time derivative term.

Results:
* 3D block-type VHTR reactor based on the MHTGR-350
* AER-1A benchmark problem
To test the iPRN method
iPRN method yielded more accurate results than other homogenization
methods for the partially rodded nodes.

To test the transient analysis solver they solve a reduced version of the MHTGR-350
Two scenarios considered:
- control rod ejection: ejection inserts 1.5$ of reactivity in 0.1 sec
- control rod withdrawal: ejection inserts 1.5$ of reactivity in 200 sec.
For verification of the transient thermal fluid analysis solver, the numerical results were compared to those of the CAPP/GAMMA+ coupled code.




% joo_resolution_1984
ABTRACT
Research to develop an accurate, systematic, inexpensive, and reliable procedure for resolving the control rod cusping problem for nodal methods in light water reactor calculations.
The cusping problem arises if the presence of a control rod partially inserted in a large spatial mesh node is represented by homogeneous cross sections of magnitudes proportional to the volume of control rod material present.
A plot of reactivity vs control rod position then exhibits unphysical cusps as the rod is withdrawn from node to node.
This effect causes conventional procedures to yield incorrect nodal power distribution and reactor eigenvalue.

CHAPTER 1
When using a nodal model, the cross sections are homogenized over a whole node.
The presence of control rods partially inserted in a node causes an axial heterogeneity.
The cross sections are then homogenized for the node.
If such homogenization is found by a simple volume averaging procedure, the resultant nodal power distribution and reactor multiplication factor are incorrect.

It is possible to circumvent this difficulty by requiring that there be horizontal nodal interface planes positioned at every control rod tip position.
For reactor transients during which control rods are moving and power dependent feedback effects are being accounted for, complications become more severe.
To solve the issue, the partially roded node is homogenized.
Volume weighted cross sections causes the control rod cusping problem.
Other models: flux-weighted cross sections.

Chapter 3:
A partially roded node PRN is present whenever the control rod tip locations do not match exactly the axial nodal interfaces.




% CAPP
% lee_development_2008
ABSTRACT
Development of a neutron diffusion equation solver based on the finite element method for CAPP code.
The diffusion equation solver was validated against two benchmark problems: IAEA PWR benchmark problem and OECD/NEA PBMR 400 benchmark problem.
Implementation of different shapes of elements in 2 and 3D to allow the code to solve complex geometries.
The solution converged to the reference solution as the finite elements are refined and as the order of the finite elements increases.
Numerical tests showed that the higher order finite element method is more efficient than lower order finite element method or finite difference method.

INTRODUCTION
Korea Atomic Energy Research Institute (KAERI) developed the Core Analyzer for Pebble and Prism type VHTRs (CAPP) code.
The code's purpose is to conduct steady state core physics analysis, core depletion analysis, and core transient analysis.

% on the choice of FEM vs FDM and Nodal methods
FDM-based solvers have a drawback of a long computation time and huge memory requirement.
FEM has several advantages over the nodal methods. 
It provides flexibility in geometry, firm mathematical basis, ease in extension to multi-group application, and high computational efficiency.

It is possible for us to define finite elements (FEs) with nearly arbitrary shapes and sizes.
Nodal methods are applicable for the nodes of a specific shape on which the nodal method was derived.

FEM provide mathematically well established finite element approximation in discretizing space variables while transverse-integrated nodal methods on non-cubic nodes introduce extra approximations during the transverse integration procedure.
It is straight forward to apply FEM to the multi-group neutron diffusion equations.
FEM is also very efficient compared to the nodal methods which utilize analytic functions on non-cubic nodes.

NUMERICAL RESULTS
IAEA PWR benchmark problem
Results for differnet number of elements per fuel assembly and for different order of shape functions.
IAEA PWR benchamrk problems in 2D and 3D.

OECD/NEA PBMR400 benchmark problem
Phase I Exercise 1 is a neutronics stand-alone case with fixed cross-sections
Results obtained for different order of shape functions.
The values reported are the keff and the power density distribution in different zones of the reactor.
The higher order FEM solution method requires much less CPU time than the lower order FEM or fine mesh finite difference method.

CONCLUSIONS
The solutions converge to the reference solution as the number of elements or the order of shape functions  increases.
The higher order FEM is much more efficient than a low order FEM or a fine mesh FDM.



--------> Left here
% lee_development_2011




% tak_cappgamma_2016




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Multi-physics %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

