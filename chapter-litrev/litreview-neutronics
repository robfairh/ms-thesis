%%%%%%%%%%%%%%%%%%%% Neutronics %%%%%%%%%%%%%%%%%%%

% wagner_three-dimensional_1989
The nodal methods developed for hexagonal geometry are similar to the analogous Cartesian geometry
nodal diffusion theory developed earlier at Siemens/KWU. %finnermann_new_1975 %finnemann_atomkernenergie_1977

The code HEXNOD calculates three-dimensional problems for fast reactors and high converter light water reactors.
It implements a nodal mehtod for solving the multigroup neutron diffusion equation.

They demonstrated the accuracy of nodal methods by comparison with the finite difference methods and Monte Carlo calculations for a number of benchmark problems.

They conclude that the code HEXNOD is well suited for 3D routine analysis of fast reactors.

Earlier heaxagonal nodal diffusion methods that apply the transverse integration procedure are based on the nodal expansion method (NEM).
In this paper they use an approximate analytic solution for the transverse-averaged group fluxes.

Nodal methods explanation:
The transverse integration procedure is used for deriving auxiliary one-dimensional diffusion equations.
In the case of a hexagonal prismatic node, this leads to a set of coupled one-dimensional equations for three spatial directions in the radial plane plus one equation for the axial direction.
These equations are then solved simultaneously.




% fitzpatrick_developments_1995
Introduces solution techniques for the time-dependence of the diffusion equations and couples it to spatial nodal algorithms.
The solution in 1D problems is compared against finite-difference solutions.




% ortensi_deterministic_2010-1
INL conducted a benchmark exercise based on modeling the High Temperature Test Reactor (HTTR).

26 energy group structure from IAEA benchmark.

Previous work on the HEXPEDITE methodology has tested the approach against other spatial discretizations for the neutron diffusion equation in hexagonal and triangular geometry, such as the nodal expansion method (NEM) and finite difference method (FDM). These studies have established HEXPEDITEâ€™s superiority in terms of accuracy and runtime over NEM and FDM.

Cross sections generated with DRAGON 4.
Cross sections used in the HEXPEDITE runs.

HEXPEDITE results for different critical configurations compared against MCNP5 and Serpent.
%Brown, F. B., et al., 2002, MCNP Version 5, LA-UR-02-3935, Los Alamos National Laboratory.

The results obtained with DRAGON-HEXPEDITE are compared against the results from other codes.
other codes: JAR (diffusion nodal), CITATION (diffusion FDM), CRONOS2 (diffusion-transport)
Results from the CRP-5 benchmark.

I say this: disadvantages of HEXPEDITE over FEM
A correction has to be applied to the multiplication factor.
HEXPEDITE cannnot accurately model the cylindrical periphery of the permanent reflector.

% for methods (tools):
One of the main issues with the generation of cross section in HTRs is the strong coupling between the blocks.
This strong coupling invalidates the assumption made in the lattice physics calculation (identical neighbors in an infinite domain).
In an ideal situation one would attempt to generate the cross sections from a 12th, 6th, or full core calculation that would consider all neighbor effects.




%lee_status_2006
* Energy Group Study:
HTGR analyses require more energy groups than conventional LWR analysis because the spectral interactions between fuels and fuel and reflector are significant due to a much longer neutron mean free path.
In this work, the number of energy groups versus accuracy has been studied using the one-dimensional fuel-reflector problem.

Fuel block cross sections are normally generated from a single fuel block calculation with reflective boundary condition, assuming that the spectrum of the single block configuration is not much different from the actual one in the core.
The effects of energy group structure on the accuracy of homogenized nodal cross sections were examined by changing the number of energy groups from 4 to 23 groups.
Cross sections were generates with DRAGON at 300 K.

One of their conclusions is that the number of energy groups should be more than 4, and 7 or more would be sufficient for uranium fueled HTGR.
The accuracy is sensitive to the energy group boundaries.

Table 12 shows results.

-----> To read: Some of this should go into the lit review when I mention the choice of method.

In parallel to developing a suite of codes based on the conventional two-step lattice and whole-core calculation approach, it is important to envision and develop analysis tools for the future.
These tools should eliminate the approximations inherent in the multi-step approach for whole-core analysis and be of higher accuracy and also less cumbersome to use.
These attributes indicate that the future codes be based on a spatially-heterogeneous capability that eliminates the various stages used in current state-of-the-art tools.
One obvious choice of a code would be that based on the stochastic Monte Carlo approach.
The Monte Carlo techniques provide detailed solution of the neutron transport problem in space, energy, and angle and could be applied with great accuracy to the VHTR if fuel particles are modeled explicitly in the core calculation.
The utilization of the Monte Carlo codes is however currently unattractive because of the tremendous problem size and the need for a large number of neutron histories required for resolution of fuel element power distribution and small reactivity effects.
Furthermore, several important phenomena such as thermal feedback at power generating conditions, flux uncertainty propagation in the depletion calculation and fission product build up are not properly addressed
in these tools at the current time.
In contrast, the direct three-dimensional whole-core transport calculation employing deterministic solution techniques provides a possibility for resolving all these problems as long as the double heterogeneity modeling capability is properly incorporated.

The DIF3D core solves the three-dimensional multigroup diffusion or transport equations for given core configurations.
It has several solution options such as the finite difference diffusion theory method (FDM), the nodal expansion diffusion theory method based on the transverse integration procedure, and the VARIANT nodal transport method.

% for conclusions
Moltres has a limited capability to represent the burnup dependency of cross sections.
The cross sections of VHTR fuel elements vary significantly with burnup and fuel and moderator temperatures.
Thus, a more general capability to represent the cross sections as a function of burnup and temperatures needs to be implemented.




%lewis_finite_1981
Discretization of the spatial variables of multi-dimensional neutron diffusion equation [4].
In this work, the author places their efforts on reducing the number of patial nodes required in the simulations.

The author applies the diffusion approximation with the finite element discretization to a variety of transport problem classes.

Concluding section with the limitations of the work to date and suggests possible future directions.

Ref 10-15




% kang_finite_1973




% yuk_time-dependent_2020
Reactor analysis tool should be capable of carrying out transient calculations for a reactivity insertion accident.
Time dependent neutron diffusion equation solved by the FEM.
Simplified thermal fluid analysis tool implemented to consider thermal feedback.
New method introduced to resolve control rod cusping effect without additional computation or mesh reconstruction.
These methods are applied to the reactor physiscs code CAPP.

The characteristics of a VHTR are different from those of conventional light water reactors.
This has led to the demand for a new reactor analysis tool.
Neutronics/thermal-fluid coupled analysis is also required due to the strong interaction between the temperature and the power in a VHTR core.
Benchmark problem based on the MHTGR350:
- ORTENSI et al. 2015
definition of the Benchamrk
- Strydom et al. 2016
PHISICS deterministic transport code coupled to RELAP5-3D
- Lemaire et al. 2017
Monte Carlo transport code MCS and GAMMA+

CAPP code for the reactor physics analysis of VHTRs
Lee et al. 2008, 2011, 2014
CAPP code performs a neutron diffusion calculation based on FEM
Becker et al. 1981
The code seeems to have its own thermal fluid analysis solver.
This paper expands upon ealier conference papers
Yuk et al 2018a, 2018b
and it extends the functionality of the CAPP code to the transient analysis.
Thermal fluid analysis code developed to consider the thermal feedback effect.
Reduction of the control rod cusping effec.

Control rod cusping effect:
Joo, 1984 % joo_resolution_1984

During the transient calculation with the control rod movements, partially rodded computation nodes (PRNs) usually appear.
The homogenization of PRNs is necessary for conventional diffusion nodal methods.
When the conservation of the reaction rates in PRNs is not considered, such homogenization induces a large error.

Various methods to reduce this effect:
- Flux volume weighted homogenization
- Homogeneous flux volume weighted homogenization
- Heterogeneous flux volume weighted homogenization
This methods require to solve the whole core problem repeatedly updated cross sections.

Mesh reconstruction is used to remove such partially rodded cases and removes the control rod cusping effect.
The reconstruction should be performed at each time step.


Reference:
VW: volume weighted homogenization
HFVW: Homogeneous flux volume weighted homogenization
However, this memethods solve the whole core problem with repeatedly updated cross sections.
The mesh reconstruction method removes the control rod cusping effect.
The method requires a mesh reconstruction at each time step.

The article introduces a method that integrates over partially rodded computation nodes (iPRN).
With this method, the control rod cusping effect cannot occur.

The article compares this methods taking the results from the mesh reconstruction method as the reference results.

I need to re read this.
...

Cross sections generated by DeCART2D.
This code system has different characteristics from those of the light
water reactors.
A prismatic VHTR has a large flux gradient.
Hence, a single assembly block calculation with the reflective boundary condition cannot give a reliable homogenized group constant set.
(I say this: Also that doesn't get the cross sections in the inner and outer reflectors.)

Due to the graphite, the resonance and up-scattering treatment are more important in a VHTR.
A conventional two energy group structure has limitations when it comes to handling such phenomena.

The authors recommend homogenizing the group constants using at least 10 energy groups.

Thermal-fluid analysis:
CAPP code has a simplified thermal fluid analysis solver
Lee et al. 2011

The geometry details are simplified in the analysis.
The unit of the thermal calculation is the triangular prism as in a neutron diffusion solver.
(The fuel assembly is represented by 6 triangles)
Each triangular prism has a representative coolant channel (Fig. 2)

Once the temperature in the coolant was calculated. then a 2D model calculates the temperature in the moderator and fuel.
It is necessary to know the temperature in the reflector due to the core/reflector spectrum interference effect.

After calculating the coolant temperature, a two-dimensional model calculates the temperature in the fuel and the moderator.

The model makes the assumption that all the energy produced in each prism contributes to the temperature rise of the coolant.
The boundary conditions of the 2D model are the coolant temperature at the hole.
The other surfaces are adiabatic.

The CAPP code uses predetermined 2-D tables of thermal conductivity for each material.
For a given fast neutron fluence and temperature, the code obtains the thermal conductivity by interpolation.

Transient calculations:
The variation of fluid temeprature during the transient calculation is rather small.
The equation for a coolant channel is then the same as that for a steady-state calculation.
Solid regions incorporate the time derivative term.

Results:
* 3D block-type VHTR reactor based on the MHTGR-350
* AER-1A benchmark problem
To test the iPRN method
iPRN method yielded more accurate results than other homogenization
methods for the partially rodded nodes.

To test the transient analysis solver they solve a reduced version of the MHTGR-350
Two scenarios considered:
- control rod ejection: ejection inserts 1.5$ of reactivity in 0.1 sec
- control rod withdrawal: ejection inserts 1.5$ of reactivity in 200 sec.
For verification of the transient thermal fluid analysis solver, the numerical results were compared to those of the CAPP/GAMMA+ coupled code.




% joo_resolution_1984
ABTRACT
Research to develop an accurate, systematic, inexpensive, and reliable procedure for resolving the control rod cusping problem for nodal methods in light water reactor calculations.
The cusping problem arises if the presence of a control rod partially inserted in a large spatial mesh node is represented by homogeneous cross sections of magnitudes proportional to the volume of control rod material present.
A plot of reactivity vs control rod position then exhibits unphysical cusps as the rod is withdrawn from node to node.
This effect causes conventional procedures to yield incorrect nodal power distribution and reactor eigenvalue.

CHAPTER 1
When using a nodal model, the cross sections are homogenized over a whole node.
The presence of control rods partially inserted in a node causes an axial heterogeneity.
The cross sections are then homogenized for the node.
If such homogenization is found by a simple volume averaging procedure, the resultant nodal power distribution and reactor multiplication factor are incorrect.

It is possible to circumvent this difficulty by requiring that there be horizontal nodal interface planes positioned at every control rod tip position.
For reactor transients during which control rods are moving and power dependent feedback effects are being accounted for, complications become more severe.
To solve the issue, the partially roded node is homogenized.
Volume weighted cross sections causes the control rod cusping problem.
Other models: flux-weighted cross sections.

Chapter 3:
A partially roded node PRN is present whenever the control rod tip locations do not match exactly the axial nodal interfaces.




% CAPP
% lee_development_2008
ABSTRACT
Development of a neutron diffusion equation solver based on the finite element method for CAPP code.
The diffusion equation solver was validated against two benchmark problems: IAEA PWR benchmark problem and OECD/NEA PBMR 400 benchmark problem.
Implementation of different shapes of elements in 2 and 3D to allow the code to solve complex geometries.
The solution converged to the reference solution as the finite elements are refined and as the order of the finite elements increases.
Numerical tests showed that the higher order finite element method is more efficient than lower order finite element method or finite difference method.

INTRODUCTION
Korea Atomic Energy Research Institute (KAERI) developed the Core Analyzer for Pebble and Prism type VHTRs (CAPP) code.
The code's purpose is to conduct steady state core physics analysis, core depletion analysis, and core transient analysis.

% on the choice of FEM vs FDM and Nodal methods
FDM-based solvers have a drawback of a long computation time and huge memory requirement.
FEM has several advantages over the nodal methods. 
It provides flexibility in geometry, firm mathematical basis, ease in extension to multi-group application, and high computational efficiency.

It is possible for us to define finite elements (FEs) with nearly arbitrary shapes and sizes.
Nodal methods are applicable for the nodes of a specific shape on which the nodal method was derived.

FEM provide mathematically well established finite element approximation in discretizing space variables while transverse-integrated nodal methods on non-cubic nodes introduce extra approximations during the transverse integration procedure.
It is straight forward to apply FEM to the multi-group neutron diffusion equations.
FEM is also very efficient compared to the nodal methods which utilize analytic functions on non-cubic nodes.

NUMERICAL RESULTS
IAEA PWR benchmark problem
Results for different number of elements per fuel assembly and for different order of shape functions.
IAEA PWR benchmark problems in 2D and 3D.

OECD/NEA PBMR400 benchmark problem
Phase I Exercise 1 is a neutronics stand-alone case with fixed cross-sections
Results obtained for different order of shape functions.
The values reported are the keff and the power density distribution in different zones of the reactor.
The higher order FEM solution method requires much less CPU time than the lower order FEM or fine mesh finite difference method.

CONCLUSIONS
The solutions converge to the reference solution as the number of elements or the order of shape functions  increases.
The higher order FEM is much more efficient than a low order FEM or a fine mesh FDM.


% lee_development_2011
The same authors published another article \cite{lee_development_2011} in 2011, where they extend the functionalities of the CAPP code to prismatic \glspl{HTGR}.

The code uses a simplified scheme to solve the thermo-fluid equations.
The thermo-fluid solver divides fuel column in six triangles that host a representative coolant channel.
Solving the energy equation, the code calculates the axial coolant temperature distribution.
With a two-dimensional conduction model, the code solves the moderator temperature.
The model obtains the fuel temperature by means of a TRISO particle conduction model.
Finally, a three-dimensional conduction model based on the \gls{FDM} allows for solving the reflector temperature.
The cross-sections are a function of burnup, moderator temperature, and fuel temperature.

Additionally, the authors implemented a depletion solver based on the one-group flux determined by the neutron flux solver.

VERIFICATION RESULTS
To validate their model, the authors solve a two-dimensional model of the PMR200 at BOC.
They compared the results against the results obtained with HELIOS.

The authors validated the depletion solver by calculating the multiplication factor as a burnup function of a single fuel block of the PMR200.
They compared the results against the results obtained with HELIOS.
The maximum error is less than 200 pcm.

CONCLUSIONS
The results showed a good accuracy of the CAPP code for the 2D PMR200 core.




% tak_cappgamma_2016
INTRODUCTION
Only a few studies on the coupled analysis of prismatic \glspl{HTGR} are available.
* Damian et al. 2008:
Coupled analysis using NEPHTIS3/CAST3M for a 600 MWth \gls{HTGR}.
He focused on the possibility to improve the reactor performance by changing some design parameters.
* Rohde et al. 2012:
Development of the coupled three-dimensional neutronics and thermo-fluid code DYN3D-HTR.
A reduced core was the focus of the coupled analysis.
* Connolly et al. 2013:
Neutronics and thermal-fluid calculations using two existing solvers, COMET and a thermo-fluid module.
Whole core calculation including detailed temperature information at the fuel pin level and explicit power calculations of individual pins.

This work:
Development of a code system for coupled neutronics and thermo-fluid simulations using CAPP and GAMMA+ codes.
GAMMA+ is a system code for thermo-fluid analysis and system transients.
Previous publications related to CAPP and GAMMA+: 
* Lee et al, 2010a, 2012, 2014
* Jun et al, 2009, 2011
* Kim and Lim, 2011
In this work, the code CAPP/GAMMA+ analyses the PMR-200 which was pre-conceptually designed by KAERI.
The authors paid special attention to the effect of the bypass flow modeling.
They analyzed its effect on the coupled behavior.

GAMMA+ CODE
The GAMMA+ code has the capability of multi-dimensional multi-component mixture analysis.
It is capable of investigating various phenomena occurring in a HTGR such as pressurized or depressurized conduction cool down and air/water-ingress accidents.
The fluid governing equations use the 1-D form of the mass, momentum, energy, and species conservation equations.
For solids, GAMMA+ uses three different scales of heat conduction models:
(1) heat conduction model to calculate the temperature profile in TRISO particles
(2) implicit coupling to consider the heat exchange between a fuel compact and TRISO particle
(3) multi-dimensional heat conduction model of the hexagonal fuel and reflector blocks

The GAMMA+ code solves both compressible and incompressible flows.
It uses the \gls{FDM} for the momentum equation and the \gls{FVM} for the scalar equations.
More detailed description in:
* Lim and No, 2006
* Lim 2014

APLICATION to PMR-200
HELIOS generated the cross sections
Heat transfer through the helium gap between the fuel compact and the graphite block was modeled with solid heat conduction and radiation.
Radiation heat transfer across the bypass gaps was neglected.
Heat loss by convection and radiation at the reactor pressure vessel to the reactor cavity cooling system (RCCS) was also neglected.

STEADY-STATE PERFORMANCE ANALYSIS
They performed a steady-state performance analysis.
They generated 10-group cross sections using HELIOS and DeCART code.

CORE DEPLETION CALCULATION WITH REACTIVITY SEARCH
They calculated the multiplication factor of the core at every burnup step of the equilibrium cycle of the PMR-200 from BOC to EOC.

CORE DEPLETION CALCULATION WITH CRITICAL CONTROL ROD POSITION SEARCH
They conducted a control rod position search for each burnup step of the equilibrium cycle of the PMR-200 from BOC to EOC.
One of their presented results is the variation of the radially averaged axial power density profile at BOC, MOC, and EOC.
The power density peak shifts towards the top of the core throughout the cycle due to the combined effect of the control rod movement and the burn out of the burnable poison in the fresh fuel.
They also present results on the variation of the radial temperature profile at BOC, MOC, and EOC.
For BOC and MOC, the fuel temperature of the inner ring is higher.
At MOC there is a steep temperature gradient.
At EOC the temperature profile is relatively flat.
One of the results shows the maximum fuel temperature throughout the reactor cycle.
The temperature reaches the maximum value near MOC.

EFFECT OF BYPASS FLOW:
Examples of other studies: 
* Bays et al 2006
* Nakano et al 2007
* Jo et al 2008
* Rohde et al 2012.
Other codes: MASTER-GCR (Jo et al, 2008), DYN3D-HTR

In order to examine the effect of bypass flow, the GAMMA+ model considered and did not consider the bypass gap in separate runs for the BOC of the PMR-200 equilibrium cycle.
In the case of no bypass gaps, the temperatures of the active core region were lower since more coolant flows through the coolant channels.
The temperatures of the central and side reflectors were higher because of the lack of convection flow.
The combined effect of the temperature changes increases the multiplication factor by approximately 300 pcm.
However, the power density changes are not appreciable.




%strydom_inl_2013

MOOSE neutronics kernel library Yak.
The neutron diffusion models initially developed for Pronghorn have been either rendered obsolete or incorporated into Yak.
RattleSnake has become the primary tool for solving the linearized Boltzmann neutron transport equation within MOOSE and relies heavily on the use of Yak.
There are a variety of solvers available under RattleSnake including low-order multigroup diffusion, spherical harmonics transport, and discrete ordinates transport all solved with the \gls{FEM}.




%wang_rattlesnake_2019

Rattlesnake is the MOOSE \cite{gaston_moose_2009} based application for simulating the physics of radiation transport.

Rattlesnake is a deterministic transport solver.

Rattlesnake is a transport solver based on the finite element method (FEM) discretization of the spatial independent variables.
FEM is a numerical technique for finding approximate solutions to PDEs by deriving their weak or variational form.
The variational form of the PDE can then be converted into a system of algebraic equations that can be solved numerically.
The advantages of FEM include an accurate representation of complex geometries, the ability to capture local effects and more.

A uniform multiphysics FEM framework can facilitate the data transfer for coupling multiple physics.




%j_ortensi_relap-7_2012
ABSTRACT
This work couples the reactor analysis code Pronghorn to RELAP-7.
The report details the mathematical models, type of coupling, and testing of the integrated system.
RELAP-7 is a MOOSE-based application that solves the continuity, momentum, and energy equations in 1-D for a compressible fluid.
Pronghorn solves the coupled equations that define the neutron diffusion, fluid flow, and heat transfer in a 3-D code model.

INTRODUCTION
RELAP-7 focuses on system analysis-type simulations.

SYSTEM INTEGRATION AND TESTING
The integration of RELAP-7 and PRONGHORN will be a loose coupling, where each application will use an independent mesh.

To carry out the testing, the system will carry out the OECD/NEA Coupled Neutronics-Thermal Fluids Benchmark.
The Pronghorn geometry will entail 1/3rd core symmetry in 3-D of the MHTGR-350.

34 cross section regions.
The modeling of the riser flow channels is ommitted from this test.
The steady state neutron diffusion equation will be solved for 26 groups.
Non-local heating effects and radiation heat transfer will be neglected.




% j_ortensi_initial_2012
INTRODUCTION
INL has initially developed the PRONGHORN code to model gas cooled pebble bed reactors.
The code solves the neutron diffusion equation, with a Darcy fluid flow model, and a conjugate heat transfer model for solid and fluid energy transfer.

GEOMETRY DESCRIPTION
The original model required significant modifications to perform this initial coupling study due to the complexity of the benchmark and shortcomings in both PRONGHORN and the RELAP-7 applications.
The simplified models retains the essential features of the General Atomics MHTGR-350 MW th design.

The original benchmark provides a set of 26 neutron energy group and temperature dependent cross sections.
This exercise collapses the 26 groups into two groups.
With two groups there is a loss of accuracy in the neutronic calculations for HTRs.
The expected error is near 2000 pcm.
Nevertheless, the lower number of groups decreases the calculation time by a factor of ten or more and greatly simplifies debugging, which is the primary focus of this initial coupling.

The original 3-D geometry with 1/3rd core symmetry was simplified to a 2-D cylindircal (R-Z) model.
The model is 11.1 m tall and 2.97 m in radius.
The active core measures 7.9 m in height and radially 0.92 m for the annular region width.

The coolant flows directly into the top reflector, followed by the active core, and, finally, the bottom reflector.
Non-local heating effects and radiation heat transfer are neglected

The RELAP-7 model consists of 1-D pipes and junctions.
This model represents the plant system layout, which includes the hot and cold ducts, the helium circulator, and the steam generator.

SYSTEM TESTING
For the testing of PRONGHORN solved each physics (neutronics, heat conduction, pressure, and momentum, and fluid energy) separately.
Study of the spatial convergence using first order and second order lagrange polynomials.
A finer mesh in the regions directly above and below the core have a stronger impact than refinements in the resto of the geometry.
Second order lagrange functions showed much better convergence.

Another study focues on the convergence behavior of the eigenvalue and thermal fluid properties as a function of the Newton steps taken.

The testing includes 2 stages: (1) both codes working independently uderwent several convergence studies, and (2) the codes solve the steady-state problem in an integrated manner.

CONCLUSIONS
The RELAP-7 and PRONGHORN applications have been successfully coupled using an operator split approach.




% ellis_initial_2014
In this study, INL used an PWR benchmark to validate RattleSnake low order diffusion solver.

ABSTRACT
The INL team decided to use the Benchmark for Evaluation and Validation of Reactor Simulations assembled by the MIT.
The data of the benchmark includes two cycles of detailed measured PWR operational data.
The results from this initial study show the current INL analysis procedure with DRAGON4 and the low order diffusion solver in RattleSnake yield encouraging results for PWR analysis.




% strydom_inl_2013
In this study, INL used an HTGR benchmark to validate RattleSnake low order diffusion solver...

ABSTRACT
The INSTANT, Pronghorn, and RattleSnake codes were used for the standalone core neutronics modeling of Exercise 1.
Section 4 compares the results from the different codes.
The Exercise 2 of Phase I requires the standalone steady-state thermal fluids modeling.
RELAP5-3D performed this exercise.
Section 5 presents and discuss its results.
Section 6 reports the coupled neutronics and thermal fluids steady-state solution for Exercise 3 using the PHISICS/RELAP5-3D code suit.

INTRODUCTION
Another validation study:
Study on the Very High Temperature Reactor Critical (VHTRC) experimental dataset [4]:
[4] OECD/NEA. International Handbook of Evaluated Reactor Physics Benchmark Experiments. 2013.
Conducted with stochastic and deterministic codes (Helios, DRAGON, Pronghorn).

As part of the benchmark simulation activities, INL coupled the PHISICS reactor physics package to the system thermal fluid code RELAP5-3D to enable temperature feedback in core simulations.
The INL team performed a detailed study on the spatial resolution required by flux and temperature profiles to support accurate transient analyses.
This study compares the traditional ring model approach with a more detailed triangular geometry model.

The report also includes the results from Pronghorn applied to the Phase I Exercise 1.

% This summary will be missing a more detailed description of the solution of the benchmark using PHISICS/RELAP coupling.

EXERCISE 4
The benchmark provides the macroscopic cross-sections for 232 sub-domains that have a 26 energy group structure.
Both RattleSnake and Pronghorn yield the same exact results when using the continuous \gls{FEM} multigroup diffusion option in RAttleSnake.
26,195,806 DoFs.

Section 4 presents the results from Rattlesnake, Pronghorn, and INSTANT.
The cross-sections used in INSTANT were modified to return the diffusion solution.




%lautard_cronos_1990 / iaea_advanced_1992
The CRONOS code's original purpose was the calculation of \glspl{PWR}, including design, fuel managment, and accidents.
CRONOS allows steady state and transient multigroup calculations taking into account the thermal-hydraulic feedback effects.
The code solves either the diffusion equation or the even parity transport equation.
The code uses the \gls{FDM} or the \gls{FEM} discretization.
A three-dimensional hexagonal geometry solver is available in the code.



%damian_vhtr_2008
ABSTRACT
Damian et al. \cite{damian_vhtr_2008} conducted a study aimed at understanding the physical aspects of the annular core and the passive safety features of a standard block type \gls{HTGR}.
They performed the analysis of various geometrical scales: fuel cell and fuel column located at the core hot spot, 2D and 3D core configurations including the coupling between neutronics and thermal-hydraulics.

The authors conducted a parametric study on the maximum fuel temperature by modifying the fuel compact and the fuel element geometry.
For the fuel compact analysis, an annular fuel compact yields the best performance.
For the fuel element analysis, a reduction of the number of fuel compacts in the outer ring reduces the maximum temperature by up to 70$^{\circ}$C.
Another parametric study consisted in the reduction of the power peaking factor and the maximum fuel temperature by modifying the fuel element location.
% results?
Other studies included the variation of the bypass fraction and the replacement of the graphite in the reflector by other materials.

INTRODUCTION
The first part of the assessment concerns thermal calculations on steady-state core configurations.
Such study uses CAST3M code considering a 3D thermal coupled with 1D hydraulic modeling.
Transport code APOLLO2 calculates the pin power distribution.
Such power distribution serves as input for the thermal calculations.

The second part of the assessment uses a 2D core configuration using the APOLLO2 code to minimize the radial power peaking factor.
The analysis includes the variation of various parameters such as fuel enrichment, fuel loading, and the fuel management scheme.

The last part of the study analyzes a 3D core model using the coupled code NEPTHIS/CAST3M.
The study varies several design parameters and studies the impact on the power distribution.
Such parameters are the helium by-pass fraction, average power density, core geometry, reflector materials, and fuel loading strategy.

NEUTRONIC AND THERMAL-HYDRAULIC COUPLING MODEL
The advanced coupling system for block type HTGR is an external coupling system.
The codes NEPTHIS and CAST3M/Arcturus calculate the neutronics and the thermal-hydraulics, respectively.
NEPHTIS uses a transport-diffusion calculation scheme that relies on APOLLO2 and the diffusion code CRONOS2.
The CAST3M/Arcturus model uses a two-level approach.
On the first level, the porous media model solves the homogenized system and the coolant.
On the second level, the CAST3M code solves the thermal-hydraulics on the homogenized geometry.

The initial coupling model was unable to accurately calculate the thermal coefficient in the fuel because it did not take into account the difference between the moderator and the fuel temperature.
A major improvement of the model is a de-homogenization calculation which guarantees a better description of the local thermal calculation in the fuel.

FUEL ELEMENT ANALYSIS
The reduction of the peaking factor decreases the maximum fuel temperature.

NEUTRONIC ANALYSIS
The fuel enrichment has the strongest impact over the peaking factor.

INFLUENCE OF BYPASS FRACTION
The increase of the fluid fraction in the active core reduces the maximum fuel temperature.
However, such reduction has a limit.
The reduction of the bypass fraction leads to and increase of the average reflector temperature.

INFLUENCE OF THE REFLECTOR MATERIAL
The magnesium oxide (MgO) has better thermal properties than graphite (the $\rho c_p$ ratio is about 1.8).
The results showed that the magnesium oxide (MgO) reduces the maximum fuel temperature during the Loss of Forced Convection (LOFC) transient.
The analysis also showed that during normal operation, the presence of MgO in the inner and outer reflectors decreases the maximum fuel temperature.

CONCLUSIONS
The full core calculations showed that the radial positioning of the fuel elements yields fuel temperature gains of up to 150$^{\circ}$C.



ABOUT CRONOS (This is just for myself. I wanted to make sure that CRONOS2 was diffusion solver)
The CRONOS code is a 3D neutronics \gls{FEM} diffusion and simplified transport code developed at \gls{CEA} \cite{ragusa_feasibility_2001}.

It combines finite difference and various levels of finite elements diffusion approximations with discrete ordinate transport capabilities \cite{iaea_advanced_1992}.



--------> Left here
I am going to leave this here, and I will continue looking for sources on the energy group structure influence over the diffusion calculations.
















MORE:

on the few groups structure:
Determination of the optimal few-energy group structure for the Canadian Super Critical Water-cooled Reactor
A.Moghrabi D.R.Novog 2018
https://www.sciencedirect.com/science/article/pii/S0306454918300100

other validations of Pronghorn:
- Very High Temperature Reactor Critical experiment %strydom_inl_2013



- Things that moltres is missing:
% j_ortensi_initial_2012
Neutron leakage corrections:
With two groups there is a loss of accuracy in the neutronic calculations for HTRs unless neutron leakage corrections are employed.
Leakage corrections are currently not available in PRONGHORN.

* on heterogeneous diffusion calculations:
%sen_super-homogenization-corrected_2017
Deterministic full reactor core simulators require homogenized group constants covering the operating and transient conditions over the entire lifetime of the core.
In the case of prismatic HTGRs, the homogenized group constants are generated using lattice physics code over a block.

%krebs_calculational_1990 (p 136 of iaea_advanced_1992)
PWR core calcualtions using diffusion theory necessitate the condensation in space of the cross-sections pin-by-pin or per assembly.
The generation of cross section libraries usable in the diffusion calculation necessarily leads to space and energy condensations.
We differenciate two types of calculation methods:
* pin-by-pin calculation:
It yields a detailed neutronic representation of the pins.
This makes possible the treatment of pin or assembly heterogeneities and spatial discretization.
* homogeneous calculation:
The diffusion calculation produces a global neutronic assembly representation.
The diffusion code averages in space and energy the information from the transport calculation.


* For methods:
Using Monte Carlo lattice physics codes for generating the homogenized group constants also allows running transport simulations for the full-scale heterogeneous system, which provides the reference solutions for the validation of the calculation scheme \cite{sen_super-homogenization-corrected_2017}

@misc{sen_super-homogenization-corrected_2017,
	title = {Super-{Homogenization}-{Corrected} {Cross}-{Section} {Generation} for {High}-{Temperature} {Reactors}},
	author = {Sen, S. and Hummel, A. and Hiruta, H.},
	month = mar,
	year = {2017}
}

* on Porous media model (validation):
Studer et al. CAST3M/ARCTURUS: A coupled heat transfer CFD code for thermalâ€“hydraulic analyzes of gas cooled reactors. 2006.