%%%%%%%%%%%%%%%%%%%% Neutronics %%%%%%%%%%%%%%%%%%%

% yuk_time-dependent_2020
Reactor analysis tool should be capable of carrying out transient calculations for a reactivity insertion accident.
Time dependent neutron diffusion equation solved by the FEM.
SImplified thermal fluid analysis tool implemented to consider thermal feedback.
New method introduced to resolve control rod cusping effect without additional computation or mesh reconstruction.
These methods are applied to the reactor physiscs code CAPP.

The characteristics of a VHTR are different from those of conventional light water reactors.
This has led to the demand for a new reactor analysis tool.
Neutronics/thermal-fluid coupled analysis is also required due to the strong interaction between the temperature and the power in a VHTR core.
Benchmark problem based on the MHTGR350:
- ORTENSI et al. 2015
definition of the Benchamrk
- Strydom et al. 2016
PHISICS deterministic transport code coupled to RELAP5-3D
- Lemaire et al. 2017
Monte Carlo transport code MCS and GAMMA+

CAPP code for the reactor physics analysis of VHTRs
Lee et al. 2008, 2011, 2014
CAPP code performs a neutron diffusion calculation based on FEM
Becker et al. 1981
The code seeems to have its own thermal fluid analysis solver.
This paper expands upon ealier conference papers
Yuk et al 2018a, 2018b
and it extends the functionality of the CAPP code to the transient analysis.
Thermal fluid analysis code developed to consider the thermal feedback effect.
Reduction of the control rod cusping effec.

Control rod cusping effect:
Joo, 1984 % joo_resolution_1984

During the transient calculation with the control rod movements, partially rodded computation nodes (PRNs) usually appear.
The homogenization of PRNs is necessary for conventional diffusion nodal methods.
When the conservation of the reaction rates in PRNs is not considered, such homogenization induces a large error.

Various method to reduce this effect:
- Flux volume weighted homogenization
- Homogeneous flux volume weighted homogenization
- Heterogeneous flux volume weighted homogenization
This methods require to solve the whole core problem repeatedly updated cross sections.

Mesh reconstruction is used to remove such partially rodded cases and removes the control rod cusping effect.
The reconstruction should be performed at each time step.

I need to re read this.
...

This code system has different characteristics from those of the light
water reactors.
A prismatic VHTR has a large flux gradient.
Hence, a single assembly block calculation with the reflective boundary condition cannot give a reliable homogenized group constant set.
(I say this: Also that doesn't get the cross sections in the inner and outer reflectors.)

Due to the graphite, the resonance and up-scattering treatment are more important in a VHTR.
A conventional two energy group structure has limitations when it comes to handling such phenomena.

Thermal-fluid analysis:
CAPP code has a simplified thermal fluid analysis solver
Lee et al. 2011

The geometry details are simplified in the analysis. 
The unit of the thermal calculation is the triangular prism as in a neutron diffusion solver.
(The fuel assembly is represented by 6 triangles)
Each triangular prism has a representative coolant channel (Fig. 2)

Once the temperature in the coolant was calculated. then a 2D model calculates the temperature in the moderator and fuel.
It is necessary to know the temperature in the reflector due to the core/reflector spectrum interference effect.

% joo_resolution_1984
ABTRACT
Research to develop an accurate, systematic, inexpensive, and reliable procedure for resolving the control rod cusping problem for nodal methods in light water reactor calculations.
The cusping problem arises if the presence of a control rod partially inserted in a large spatial mesh node is represented by homogeneous cross sections of magnitudes proportional to the volume of control rod material present.
A plot of reactivity vs control rod position then exhibits unphysical cusps as the rod is withdrawn from node to node.
This effect causes conventional procedures to yield incorrect nodal power distribution and reactor eigenvalue.

CHAPTER 1
When using a nodal model, the cross sections are homogenized over a whole node.
The presence of control rods partially inserted in a node causes an axial heterogeneity.
The cross sections are then homogenized for the node.
If such homogenization is found by a simple volume averaging procedure, the resultant nodal power distribution and reactor multiplication factor are incorrect.

It is possible to circumvent this difficulty by requiring that there be horizontal nodal interface planes positioned at every control rod tip position.
For reactor transients during which control rods are moving and power dependent feedback effects are being accounted for, complications become more severe.
To solve the issue, the partially roded node is homogenized.
Volume weighted cross sections causes the control rod cusping problem.
Other models: flux-weighted cross sections.

Chapter 3:
A partially roded node PRN is present whenever the control rod tip locations do not match exactly the axial nodal interfaces.

%%%%%%%%%%%%%%%%%%%% TH %%%%%%%%%%%%%%%%%%%%

Most important ones are:
% tak_numerical_2008
% huning_steady_2014


% tak_numerical_2008

The complex geometry of the hexagonal fuel assembly hinders accurate evaluations of the temperature profile  without elaborate numerical calculations.

The unit cell model is an effective approach that reduces the computational efforts.
However, such model neglects the effects of the bypass gap flow and the radial power distribution within the fuel assembly.

HTGR advantages are an inherent safety, high thermal efficiency, and a high temperature process heat potential.
Higher fuel temperature achieves higher outlet temperature.
However, undesirably high temperatures jeopardize the integrity of the TRISO particles (as well as the fission products release).
The design limit in HTGR is 1250 C. (check)

Complex geometry of the fuel blocks hinders accurate evaluations of the fuel temperatures requiring elaborate numerical calculations.

The analyses and design of prismatic reactors has widely used simplified computational models, among which we find the equivalent cylinder model and the unit cell model.

The equivalent cylinder model has been widely adopted in the thermo-fluid analyses using one-dimensional and multi-dimensional system codes:
* NO et al. 2007 % no_multi-component_2007
* Reza et al. 2006 % reza_design_2006
* Nakano et al. 2007 % nakano_conceptual_2008

Solved the multi-dimensional head conduction based on the unit cell model:
* Bays et al. 2006
* In et al. 2006 % in_three-dimensional_2006
* Richards et al. 2007 % richards_thermal_2007
The unit cell model assumes that the heat generated in the fuel is only removed by the coolant.

Such simplified approaches are helpful to understand some basic aspects of a heat transfer in prismatic fuel blocks, and they are economical by reducing the computational efforts.
However, the simplified approaches cannot consider a heat transfer within a fuel assembly as well as a coolant flow through a gap between the fuel assemblies, which may significantly affect the fuel temperature.

Evaluations of the thermal behavior of prismatic fuels using more detailed thermo-fluid models than the unit cell model are rare, particularly in the open literatures.
General Atomics analyzed detailed thermal behaviors of the fuel blocks of HTGRs using a model named DEMISE but limited information is available in the book written by Melese and Katz (1984).
* Melese and Katz 1984

Using a CFD code named Trio_U, Cioni et al. (2004) made three-dimensional thermo-fluid simulations of prismatic fuel assemblies of a HTGR.
They modeled seven fuel assemblies in detail and paid attention to a heat transfer between the fuel assemblies with/without a blockage of the coolant channels.
* Cioni et al. 2004

Simoneau et al. (2005) numerically analyzed the passive heat removal characteristics of a prismatic VHTR using a commercial CFD code.
They applied a simplified three-dimensional reactor model.
They used homogenized triangular posts since they were interested in the overall system behavior.
* Simoneau et al. 2005

PMR600: the reference reactor is GT-MHR.
The heat generated in the fuel compacts is conducted through the graphite block and it is finally removed by the helium coolant.

Considering the effects of the dowel holes to be negligible, a 1/12 section of the fuel is enough to simulate the fuel assembly due to its symmetry.
The model includes the graphite plugs.
Uniform power density profile.
The burnup flattens out the axial power profile making it close to uniform at the end of cycle.
Amount of heat generation in the graphite plugs is negligibly small.

Re = 40000 in coolant channel and 2000 in bypass gap.
Increasing the bypass flow gap increases the fuel temperature.
The unit cell model is a reasonable approximation if the bypass flow is small and the radial power profile within the assembly is uniform.

What they did:
* three-dimensional computational fluid dynamics (CFD) analysis carried out on a typical fuel assembly of a prismatic HTGR
* results used to assess the accuracy of the unit cell model
* examine the deviation from the results by the unit cell approach due to the bypass flow between fuel assemblies and radial power variations within the fuel assembly
* flow split a the upper plenum into the flow channels is obtained by a 1D calculation by assuming the same pressure drop across the entire height of the reactor core including top and bottom reflector blocks.
* calculated flow rate is used as an inlet boundary condition for the CFD analysis.
* CFD analysis using CFX 11 (ANSYS Inc.)
* Highest temperature: 1119 C.
* Max coolant velocity 51 m/s
* Pressure drop: 25 kPa

% no_multi-component_2007
The VHTR faces some technical and economical challenges, particularly reactor safety and costs.
The air ingress event following a LOCA is a cause of concern.
Following the depressurization of helium in the core, there exists the potential for air to enter the core through the break and oxidize the in-core graphite structure.

What they did:
* Development of the code GAMMA
* Solves equations for both the gas and the solid parts.
* Use porous media model (Nield and Bejan, 1999) to consider heat transport in solid-fluid components.
* Gas flow medium: multi-dimensional governing equations for a chemically reacting flow (Poinsot and Veynante,
2001) that consist of the spatially-averaged conservation equations for continuity, momentum, energy of the gas mixture, and the mass of each species.
* Heat transfer between the fluid and the solid: h(TWall - TFluid)
* The boundary condition for the enclosure (recinto) is the radiative heat transfer. It uses the irradiation/radiosity method (Holman, 1986). The radiation exchange between surfaces is gray and diffuse.
* Improvement of RELAP5
* They added the capability to simulate air ingress following LOCAs due to the effects of molecular diffusion.

% reza_design_2006
The temperatures required for efficient hydrogen production present a unique design challenge for the reactor pressure vessel during steady-state operation.

What they did:
* Use ATHENA (that relies on RELAP5-3D) to solve MHRs
* peak steady state reactor vessel temperature of 541 C
* Propose an alternative coolant inlet flow configuration
* Calculated peak temperatures in HPCC and LPCC accidents with the new config
high pressure conduction cooldown (HPCC): 5.03 MPa
low pressure conduction cooldown (LPCC): 1 atm
* Max core velocity ~53 m/s
* Total pressure drop 57.87 kPa
* Peak fuel temperature around ~1106C at SS
* Design fuel temperature limit of 1600C

% nakano_conceptual_2008
At the beginning of burnup, the deep insertion of control rods makes the power density larger in the bottom region.
The withdrawal of control rods at the end of cycle leads larger power density at the top of the core.

The heat transfer areas are different between the actual unit cell and the analytical model.
The unit cell is asymmetric making the temperature distribution asymmetric in the graphite block.
It leads to temperature difference between actual and analytical model.

What they did:
* The fuel has a temp profile when the outlet coolant temp is 850.
* The idea is to restrain the bypass flow to leave that temp profile unchanged while increasing the outlet temp to 950.
* 3D FEM model developed on ANSYS v.10 code.
* It calculates the pressure and flow rate distribution using the Bernoulli equation.
* The 3D model includes RPV and core internals and core fuels.
* Calculates 1/3rd of the reactor: 120 degrees.
* Nuclear analysis using DELIGHT-8 to make macro cross-section sets at various burnup points.
* CITATION for the code analysis.
* Flow distribution analysis using FLOWNET: to obtain the fuel channel flow rate and pressure drop/
* Fuel temperature analysis with TAC-2D:
	- Power density from the nuclear analysis.
	- flow rate calculated in the flow distribution analysis.
	- calculation model: 2D cylindrical model for a hot channel fuel pin cell
	- the coolant channel is modeled into an annular channel around the graphite block
* FP release: Diffusion in the particles, sorption, and diffusion in the fuel matrix and in the graphite region, evaporation and mass transfer on the graphite surface into the coolant.

% in_three-dimensional_2006
What they did:
* Predict hot-spot fuel temperature distributions in a PMR at a steady state
* CFD code: CFX-10 used to perform a 3D analysis
* GT-MHR600 is the reference design
* unit cell model
* uniform cooling and constant pressure assumed at the inlet and the exit of the coolant channel
* helium mass flow rate in a coolant channel is 0.0176 kg/s
* inlet/outlet helium temperatures are 399C and 950C.
* q''' = 33.3, 33.1, 35.0 MW/m3 at BOC, MOC, and EOC
* Tmax in the fuel is 1295.3 C at EOC at the exit
* The temperature difference between the coolant (bulk temperature) and the fuel is approx 150C

% richards_thermal_2007
What they did:
* Modified fuel element design
	- analyzes using RELAP5-3D/ATHENA, POKE, and CFX.
	- 30C reduction
* reduction of the bypass flow to reduce peak fuel temperatures
* alternative inlet-flow configurations to reduce reactor vessel temperatures
* see if conventional LWR materials could be used for a VHTR vessel

ATHENA: Advanced Thermal Energy Network Analysis (Carlson, 1986)
Carlson, 1986
To asses the impact of higher coolant temperatures on steady-state vessel temperatures, parasitic RCCS heat losses, and peak fuel temperatures during LOCAs.
GT-MHR inlet configuration and two alternative inlet flow configurations evaluated
Routing the inlet flow through the inner reflector resulted in a greater loss of heat capacity, increasing fuel temperatures by 40 C during a LOCA.

POKE (Kapernick, 1993), calculations on the unit cell:
Two designs: Fort St Vrain: 10 row (10 row of fuel holes across the flats)
increased to 12 row. Also reduction of the fuel coolant holes and coolant holes.
This reduces the max temperatures by 34 C.

POKE and ATHENA:
Study the effects of lowering the coolant inlet temperature and also decrease the total coolant flow rate

% simoneau_three-dimensional_2007
3D model to simulate the passive heat removal in a MHR during a loss of active cooling accident.
Model developed using STAR-CD solves the conductive, convective, and radiative heat transfer within a 30 deg section of the core and reactor vessel.
To accommodate the different spatial scales, it uses homogeneous equivalent media to represent the coolant flow and the prismatic fuel blocks.

Two accident scenarios: despressurized conduction cooldown and pressurized conduction cooldown.
Results compared to assess the effect of internal natural convection which is neglible during the depressurized event.
Evolution of natural convection flow through the core is examined and discussed.

If the circuit is depressurized (depressurized conduction cooldown DCC) the convective heat transfer from natural convection is negligible.
The helium pressure is on the order of atmospheric pressure due to equilibrium with air in the reactor cavity volume.
If the circuit remains pressurized (pressurized conduction cooldown PCC) then the internal natural convection provides noticeable heat transfer.

Timeline for both scenarios is the same:
- Reactor operates at 600 MW
- Primary helium circulation is stopped
- protection system drops the rods automatically
In the DCC scenraio, the system rapidly depressurizes and the transient begins at a completely depressurized state.
After the loss of forced flow, natural circulation develops in the reactor as a result of the buoyancy forces.
Natural convection occurs in both the DCC and PCC scenarios. In the first case it is ignored since it is weak and the amount of heat transfer is negligible.

Partial differential equations discretized by the finite volume method, using the first order upwind differences for the spatial temrs and a first order, fully implicit scheme for the temporal discretization.
To solve pressure linked equations: SIMPLE algorithm (Patankar, 1980) and PISO algorithm (Issa et al., 1991) for the steady-state and transient calculations respectively.

During the steady-state calculations, turbulence is modeled using STAR-CD's standard linear k-e model and wall functions for high Reynolds number flow.
Heat transfer by thermal radiation modeled by face-to-face exchanges using a discrete beam method to calculate the view factors.
All surfaces are gray an diffuse.

The blocks are represented by a homogeneous equivalent solid medium, which includes both the fuel compacts and the graphite web.
The gaps between the core blocks are explicitly modeled by mesh cells.
The gap size is assumed to be 2 mm.

A distributed resistance model (porous medium) is used to represent the coolant channels in the fuel blocks.
The graphite of the fuel blocks is represented by a separate set of mesh cells.
Because the solid parts and fluid parts of the model are coupled, the two sets of cells are overlaid.
The overlapping fluid and solid cells are coupled by calculating the heat flux form the fluid to the solid: Q = K(Tf-Ts).
K represents the heat transfer by a combination of conduction, radiation, and convection.
Its values is obtained from a separate detailed, explicit model of a single fuel block.
Comparison of homogeneous and explicit model of the fuel block during a pressurized conduction cooldown.

% huning_steady_2014
Modeling and prediction of core thermal hydraulic behavior is essential for both normal operation and transient safety.
Thermal hydraulic modeling studies for early gas-cooled reactor designs such as Fort Saint Vrain and Peach Bottom Unit 1 are limited and consist mainly of support calculations for NRC safety analysis reports.

Thermal analysis methods for these early HTGRs relied on sets of independent codes that employed simplistic approximations for flow, core, assembly and fuel heat transfer modeling.

Early thermal analysis codes:
Shenoy and McEarchern 1974 % see shenoy_htgr_1974

Later reactor designs including the MHTGR and GT-MHR used the same or similar set of codes as those listed above to perform thermal analysis for safety analysis and conceptual design reports.
The central modeling technique of these analyses is the equivalent fuel-moderator-coolant triangular unit cell.
The disadvantage is that explicit fuel and graphite temperatures are not computed.

Specifically, it is of interest whether 1-D flow modeling of coolant and bypass channels provides sufficient accuracy for convective heat transfer coefficient prediction.
The issue of unit cell nodal heat transfer methods as compared to more detailed CFD was investigated in a study by Tak et al. (2008) % tak_numerical_2008

Recent studies of HTGR core thermal hydraulics can be divided into two principal categories: core heat transfer, and reactor fluid flow.
In most cases, no experimental data are available to fully benchmark the results of a particular study; therefore, design results used are mostly from the MHTGR, GT-MHR, and NGNP (VHTR).

While most of the studies discussed assume consistent sets of key design parameters such as assembly block and fuel dimensions, there is significant variation in operational parameters such as inlet coolant temperature, core flow rate or desired average coolant outlet temperature, and core power.
Graphite and fuel material properties can also be different depending on the author or study.

* Core heat transfer:
MacDonald et al. 2003 % macdonald_ngnp_2003

Study to support the NGNP.
The purpose was to quantify the impact of variations to key design parameters such as core power, power density, assembly geometry, fuel configuration and others.
They performed both steady state and transient analyses.
Analysis of maximum core temperatures by varying the bypass flow fraction, flow distribution, and reactor power.
The steady state method employed the POKE code to simulate one third of the core.
The code approximates core transfer using triangular unit cells.
The core power profile was determined from Monte Carlo reactor physics calculations.
The bypass and coolant flow distribution was fixed and not explicitly determined.

First observation: the maximum fuel temperature increases when bypass flow is increased.
Another observation: the maximum fuel temperatures could be reduced by 100C if flow could be increased in hot coolant channels and decreased in channels next to lower power or cooler fuel compacts.
Another one: Increasing core power by adding active fuel blocks above the existing active core could be achieved without increasing maximum fuel temperatures.

While these parametric studies revealed promising design modifications for the VHTR, a high degree of uncertainty remains due to the lack of explicit flow prediction and equivalent triangular unit cell modeling.

Since the NGNP point design study, there have been limited core heat transfer parametric design studies for HTGRs.
One parametric core heat transfer study was conducted by Damian 2008:
Damian 2008 % damian_vhtr_2008
* The 3D thermal hydraulic code CAST3M and neutronics calculation scheme NEPHTIS were used to determine maximum fuel temperature for a peak assembly.
* Several fuel and assembly geometry configuration changes were investigated, but none were found to offer significant advantage over the originally proposed core assembly configuration.
* Reducing radial power peaking was the most promising method for reducing peak fuel temperatures.
* Coarse discretization of porous media homogenized cells formed the basis for the core heat transfer calculations.
* Parameters such as bypass flow fraction, reflector material, power density, and control rod operation were varied to examine the impact on maximum fuel temperature
* Replacing the outer graphite reflector with magnesium oxide (MgO) could reduce the maximum transient fuel temperatures by 50C.
* Both studies macdonald_ngnp_2003 and damian_vhtr_2008 found that employing fuel management techniques reduces maximum fuel temperatures.

In addition to unit cell methods, CFD has also been used to analyze block or assembly level thermal hydraulics.
CFD code Trio_U Bieder and Graffard, 2008 % bieder_qualification_2008
Analyzed partial helium channel blocking
The code uses a hybrid finite volume finite element method for unstructured 3D grids, and supports both RANS and LES modeling.
Various RANS turbulence models can be used including the k-epsilon model, k-w based SST model, or a Reynolds stress model.

Cioni et al. 2006 examined the impact of helium channel blocking on maximum fuel temperatures.
Cioni et al. 2006 % cioni_3d_2006
24 blocked coolant channels were modeled.
The maximum steady state fuel temperatures were found to reach 1925 C.

Tak et al. 2008 compare the unit cell and CFD methods in detail.
Tak et al. % tak_numerical_2008
A flat power distribution was assumed for the axial length of the core.
Bypass flow was calculated assuming a 1 mm reference gap.
The max fuel temperature was found to be 1119 C.
The similar unit cell model maximum temperature was found to be 1099 C.
For cases with larger bypass gaps, CFD simulations indicate that maximum fuel temperatures could be up to 79C higher than the triangular cell prediction.
Conclusion: triangular unit cell methods can be safely applied to cases with low bypass flow.

This work (huning_steady_2014) presents a remedy for the triangular unit cell method to better estimate the intra-assembly heat conduction rates.

* Coolant flow:
The Nuclear Regulatory Commission (US-NRC) Office of Nuclear Regulatory Research published a Phenomena Identification and Ranking Table (PIRT) on NGNP (VHTR) safety-relevant phenomena (Ball, 2008).
Ball, 2008 % ball_next_2008

Expert panels were tasked with identifying and ranking phenomena critical to both steady state and accident conditions.
Core bypass flow was judged to be of high importance with a low or medium knowledge level.
This means that more research is needed to measure bypass flow across the core, and to develop reactor analysis tools that can predict bypass flow.
One of the modeling challenges is that since graphite changes physical shape under irradiation, bypass flow will vary axially along the core.

ANL
Lee et al, 2006 % lee_status_2006
Performed core flow modeling and sensitivity studies for prismatic modular reactors.
Modeling of coolant flow based on a 2D flow path and resistance network approach.
Each fuel assembly modeled as a single channel with additional channels for axial bypass flow and lateral cross flow.
The conservation equations for mass and momentum are solved using an assumed temperature profile based on the anticipated power profile predicted in the same study.
Objective was to identify flow paths that contribute to bypass flow the most.
Vertical assembly gaps in the replaceable reflector region and near the permanent side reflector were identified as main bypass flow contributors.
Cross flow was not found to play a substantial role in coolant flow distribution under normal operating conditions.

Sato et al. 2010 % sato_computational_2010
CFD work using FLUENT indicates that bypass flow is a complex phenomenon that is inherently coupled to neutronics, heat transfer, and fluid dynamics.
Studies using the standard k-epsilon and the Wilcox k-w model show discrepancies.
The study suggested that these turbulence models need more verification against prismatic HTGR experiments.
Another key insight was that radial power distribution has a larger effect on maximum fuel temperatures that axial power distribution.

Johnson 2008 % johnson_development_2008
CFD Analysis of the lower plenum flow.
Computations performed using FLUENT.
The simulations address several questions: whether 2D or 3D calculations, fine or coarse grids are necessary. And what boundary conditions result more appropriate.

Anderson et al. 2008 % anderson_analysis_2007
CFD model of the lower plenum.
Goal to determine the degree of mixing in the lower plenum.

* Summary
Several codes employed a number of simplifications such as fixed flow fractions in coolant and bypass channels, 1/3rd fraction of whole core analysis, and neglected axial conduction.
Triangular unit cells where a fraction of fuel, graphite and coolant were homogenized.
Fine mesh CFD methods are more accurate but have not been applied to the whole core due to computational cost.

Some approaches couple system analysis code such as RELAP for large core domains and CFD for local or detailed regions.
This could be computationally efficient and provide accurate maximum fuel temperature and bypass flow predictions.

What they did:
* redevelop the unit cell method to adequately predict the axial and radial heat conduction within each assembly block

Thermal fluid properties for graphite, helium, and fuel compact material are taken from Johnson et al, 2009.
Johnson et al. 2009 % johnson_cfd_2009

% shenoy_htgr_1974
3.2.1 Kernel Migration

4. Analytical methods
Based on the principles of conservation of mass, momentum, and energy.

Steady-state analysis: (Table 4-1)
* FLAC:
Determines the coolant flow distribution in the coolant channels and gaps.
Solves the 1-D Momentum Equation for incompressible flow.
Solves continuity eqs of mass and energy. 
Models the density changes in the gas.

* POKE:
It solves the coolant mass flow, coolant temperature, and fuel temperature distribution in an HTGR core.
Steady-state mass and momentum conservation equations for parallel channels, solved using finite differences.
Imposes the power distribution.

* DEMISE/DEMICE: determines the steady state 3D temperature distribution in 1/2 columns of standard elements (DEMISE) and control elements (DEMICE).
It solves the temperature distribution in a network model using a successive point iteration.
It calculates the flow distribution by balancing pressure drop in coolant passages.

* BACH:
It calculates the steady-state core power/flow ratio to achieve a desired maximum fuel temperature.
It calculates the coolant channel mass flow by balancing the pressure drop for a single channel.
It calculates the gas temperatures from energy balance equations.

* HEXT:
To determine steady-state temperature distribution and equivalent thermal conductances in fuel, fuel-mdoerator gap, and moderator in a unit cell of HTGR type fuel elements.
It solves the heat conduction equation in 2D geometries.

* TREVER:
To determine from given power distributions the steady-state coolant, graphite, and fuel temperatures.
TO determine time and space distribution of coating failure.
It solves 1D (radial) steady-state heat transfer.

* TAC-2D:
It is a general purpose 2D thermal analysis code.
Solves the 2D heat conduction equation by finite differences using an implicit iteration method.

* DETRAC:
Solves 1D nodal transient heat transfer equations with no axial or radial conduction between channels.

1D unit cell code BACH and HEXT
BACH 1D describes heat and coolant flow in a single coolant channel in the core.

Transient analysis:
* TAP code:
To study the overall plant transient behavior of HTGRs.
It incorporates models of all major components of the nuclear steam supply.
The reactor and primary coolant model in the program accounts for all helium temperature changes in the primary coolant system including heating in the core and cooling in the steam generator.
The reactor core model in TAP consists of one average coolant channel surrounded by graphite and fuel.
It computes the average heat generation rate in the core and computes the average coolant, graphite, and fuel temperatures in the core.

* Single Channel Analysis TAC Model:
Coolant, graphite, and fuel temperature profiles within a unit cell.
Signle rod stacj surrounded by a gap and volume of graphite with a heat capacity and conductance equal to that of a unit cell.
The model extends the entire active core length with five axial nodes per fuel block and includes the top reflector, bottom reflector, and core support blocks.
The cose uses time and temperature dependent material properties such as density, thermal conductivity, and heat capacity.

* DETRAC Code:
It calculates fuel and graphite temperatures within each refueling region.
It calculates the graphite and coolant temperatures at top and bottom reflector, and for each fuel block.

* RECA Code:
Preferred code when the radial conduction of energy between refueling regions is significant.
It calculates the axial distribution of average coolant, graphite, and fuel temperatures for each refueling region.
Reverse flow is possible for low-flow conditions and is accounted for by the core.
Cross-flow is not considered.

% macdonald_ngnp_2003
Next Generation Nuclear Plant (NGNP) presented to possible designs: one for a prismatic fuel type helium gas-cooled reactor and one for a pebble bed fuel helium gas reactor.
Both with three basic requirements: a coolant outlet temperature of 1000C, passive safety, and a total power output consistent with that expected for commercial HTGRs.

The prismatic NGNP is a design directly based on the General Atomics Very High Temperature Gas-cooled Reactor (VHTR) submittal to the Generation IV Roadmap, which was based of their gas turbine-modular helium reactor (GT-MHR) design.

An important issue involving the performance of the fuel particles is the power peaking of the fuel rods.
The areas of biggest concern are the annular core interfaces with the inner and outer graphite reflectors, but primarily the inner reflector interface.
The possible solutions are:
(1) use of allocated B4C burnable poison rod locations in the fuel blocks
(2) graded particle packing fractions in the fuel rod Rows 1, 2, 3, and 4 nearest the interface
(3) graded fuel enrichments in these same Rows 1-4
(4) replacement of specific fuel rods with burnable poisons (e.g. B 4 C)
(5) B 4 C loaded in the graphite reflector blocks in Rings 5 and 9 near the reflector/core interfaces.

What they did:
* They made parametric thermal-hydraulic design studies using POKE.
* Investigate design options that would allow 1000C outlet temperature, the highest possible overall core power, while maintaining the fuel temperature below 1250 C
* They studied the 600 MWt GT-MHR design with Tin 491 C and Tout 850 C:
	- evaluated two design modifications: reducing the bypass flow and better controlling the inlet coolant flow distribution.
* Evaluation of taller and higher power reactor cores with the POKE computer core:
	- 10 block 600 MWt, 12 block 720 MWt, and 14 block high 840 MWt
* Thermal-hydraulic model of the NGNP reactor vessel and reactor cavity developed with the RELAP5-3D/ATHENA.
	- The code and model were used to perform analyses of the transient response of the NGNP design and determine the effects of the core geometry on the peak reactor vessel and fuel temperatures.
* Sensibility calculations to determine the power that could be obtained for different core heights without exceeding a peak transient fuel temperature of 1600C.
	- 10 block 686 MWt, 12 block 786 MWt, and 14 block 889 MWt.
* Parametric analyses of the limiting temperature transient, the depressurized conduction cooldown design basis event using the TAC2D code.
	- Power and core temperature profiles from POKE
	- for 10 block, 621 MWt will limit the peak core temperature during the cooldown event to 1600 C.

Neutronic Results:
- Cool results: I could add that in my thesis.
Reactivity effects of Helium Gas insignificant

The annual fluence estimates are based on a capacity factor of 90\% and one year is assumed to be 365.25 days in length. (It is the flux * 3600*24*365.25 * 0.9).

Thermal-Hydraulic Results:
- They used POKE to perform the parametric studies.
- Analysis for a reactor configuration consisting of a number of regions. Individual columns (fuel columns) are the regions.
- For each region, POKE models an average coolant channel that is coupled to an adiabatic unit cell.
- using the coolant channel temperature as a boundary condition for convective heat transfer, 2D calculations are performed at each axial location to determine the moderator and fuel temperatures.
- gap between the fuel compact and the graphite moderator is modeled.
- conduction and radiation are assumed to occur across the gap.
- POKE calculates the flow distribution among the fuel columns nad the temperatures of the coolant, graphite, and fuel at each axial location
- POKE also calculates the axial pressure dsitribution in each column and the overall pressure drop across the core
- the temperature rise of the bypassflow is a 30\% of the overall coolant temperature rise
- the core power distribution is an input for POKE. The power distribution is based on care-physics calculations perfromed for the reference GT-MHR.
Burnable posion is zoned axially.
- Local power density is determined by multiplying the average power density by the product of a column-averaged power factor and axial power factor.
The axial power factor is a strong function of control rod position
- Power distribution at time point between the middle and end of cycle when the control rods are inserted to the axial midpoint of the active core.
This type of power distribution generally results in higher fuel temperatures since more power is shifted toward the bottom where coolant temperatures are also the highest.
- Power distributions can be flattened if a concept referred to as fuel placement is used. With this method, each column contains both new and old fuel at the beginning of an equilibrium cycle.

* RELAP5-3D/ATHENA model:
	- (Figure 60) illustrates the heat transfer mechanisms modeled between the various structures and the coolant
	- Inner reflector and core: conduction, He: convection, Outer reflector to reactor vessel and reactor vessel to RCCS: convection and radiation
	- Transient analysis: HPCC and LPCC

Decay Heat
* ANS-5.1 is not appropriate for this reactor

* TAC2D for carrying parametric studies during a LPCC event

% damian_vhtr_2008
What they did:
- fuel cell and fuel column analyses
- 2D and 3D core configurations
- including the coupling between neutronic and thermal-hydraulic

Thermal analysis at the core hot spot.
Capability to reduce the maximum fuel temperature by modifying the design parameters.
Best performance for an annular fuel compact with coolant flowing inside and outside the compact.
Changes in the fuel compact distribution: reduction of the number of fuel compact in the outer ring of the fuel element.

Full core configuration show that the radial positioning of the fuel elements allows to reduce significantly the power peaking factor and the maximum fuel temperature.
Other modifications were addressed such as the increase of the bypass fraction and the replacement of a part of the graphite reflector by material with better thermal properties.

First part: thermal calculations on the steady-state configurations.
Calculations performed on the fuel cell geometry and the fuel column geometry at the core hot spot location.
Calculations using CAST3M code: 3D thermal coupled with 1D hydraulic modeling.
Pin power distribution come from 2D core calculations performed with the transport code APOLLO2.
Parametric studies to increase the outlet temperature: reduce helium flow, increase the average power density, and increase the active core height.

Second part:
2D core configuration.
Neutronic analysis dedicated to the minimization of the radial power peaking factor.
Various options: impact of fuel enrichment, fuel loading, and fuel management scheme.

Last part:
Analysis of the 3D core model using the coupled neutronic/thermal-hydraulic tool developed by CEA.
NEPTHIS/CAST3M.
Design parameters influence evaluated:helium bypass fraction, average power density, core geometry, reflector materials properties and fuel loading strategy.
Core depletion calculations including control rods modeling are performed in order to evaluate the impact on the power distribution.

NEPTHIS is based on a transport-diffusion calculation scheme using the transport code APOLLO2 and the transport-diffusion code CRONOS2.
Transport code calculates the fuel element in an infinite medium and provides condensed and homogenized cross-sections libraries.
The CAST3M/Arcturus model uses a two level approach:
- singularities of fuel particles, fuel compacts, and helium cooling channels with inter-assembly helium cavity are homogenized to obtain equivalent thermal properties for the porous media and the cooling gas.
- Thermal-hydraulics is solved on the homogenized geometry using CAST3M.

% bieder_qualification_2008
Sort of validation of the code applied to a PWR.

% cioni_3d_2006
Investigation of the effects of channel blockage.
2 configurations investigated:
- 1 blocked assemblies surrounded by 6 unblocked
- 1 blocked assembly surrounded by 5 unblocked assemblies and 1 reflector assembly.
CFD Code Trio_U: (Bieder et al. 2000)
- 3D conduction problem in the solid
- 1D thermal-hydraulic model for Helium

Fluid-solid coupling:
Colburn correlation: Nux = 0.023 Re**0.8 Pr**0.33

Graphite and fuel compacts are modeled using the same physical properties.
The power in the fuel is a chopped cosine:
P(x) = Po * 1.2 * cos(1.0267 (2x/H-1))

% ball_next_2008
Expert panels identified safety-relevant phenomena, ranked their importance, and assessed
the knowledge levels in the areas of accidents and thermal fluids, fission-product transport and dose,
high-temperature materials, graphite, and process heat for hydrogen production.

% lee_status_2006

% sato_computational_2010
3D CFD calculations of a typical VHTR
FLUENT
Parametric studies on 1/12th of the fuel assembly
Factors: gap width, turbulence model, axial heat generation profile, geometry changes due to irradiation-induced shrinkage

Maximum fuel and coolant channel temperatures increase with the gap width increase.
The bypass flow causes a large lateral temperature gradient.

The flow bias can cause large temperature gradients in graphite fuel blocks, which raises potential structural issues because of excessive thermal stresses.

Flow network calculations and unit cell models applied in:
Takada et al 2004
Nakano et al 2008
However,
The distribution of temperature in the fuel pins and graphite blocks as well as coolant outlet temperatures are strongly coupled with the local heat generation rate within the fuel blocks which is not uniformly distributed in the core.

Tak et al. 2008, coolant mass flow computed using a separate 1D code.
In this study, the mass flow rates are determined as part of the solution.

Calculation on the GT-MHR.
number of mesh cells is 7.6 x 10^6
Pressure-velocity coupling: SIMPLE

Tak calculates flow rates separately and uses it as the BC.
However, the flow rates in the channels and gaps are a function of the friction, which is dependent on viscosity whihc is highly temperature dependent.
The mass flow rates are a function of the thermal characteristics of the problem, which are not known a priori.

Fuel compact properties: MacDonald et al. 2003 and Johnson et al. 2010.


% johnson_development_2008

% anderson_analysis_2007

% huning_novel_2016
One major step for licensing is the demonstration of successful passive safety operation of HTGRs for the design safety basis cases.
For HTGRs, these are the P-LOFC and D-LOFC cases.

Several different thermal hydraulic analysis tools exist to compute the core transient information to demonstrate LOFC safety margin.
These principally fall into three different categories: (a) CFD, (b) system level, and (c) unit cell or intermediate level.

CFD techniques are well equipped to compute the detailed assembly temperature profiles but are unable to perform whole-core calculations due to computational costs.

System-level codes such as RELAP are well equipped to compute core-level temperature profiles but it is also difficult to approximate the assembly geometry correctly using simple equivalent cylinder or slab models. 

Unit cell and intermediate level techniques have he highest potential since whole-core calculations are possible with computed pin or near-pin-level temperature gradients for the hexagonal fuel assembly geometry.


Due to the significantly different flow and core geometry for gas reactors, typical LWR codes may not be suitable for the analysis of HTGRs.
Some options are to couple CFD core heat transfer calculations to system level calculations by relap.
Another option is using MELCOR-H2 for modeling secondary side transient analysis.
GAMMA+ code:
Kim et al 2010 % 
GAMMA+ code is a code developed specifically to analyze air ingress events and hydrogen plant transients.
It solves the conservation equations for a mixture of many gas species and solid nodes.

The methology for simulating transients is different to simulating steady state temperatures.
Transient simulations can progress for hundreds or thousands of hours, so usually the spatial resolution in transient simulations is poorer than in steady state simulations.

CFD:
- Trio_U: Bieder and Graffard 2008 % bieder_qualification_2008
- FLUENT
- Fuego Sandia National Laboratories
- CFX 11, ANSYS
- STAR-CCM+, CD-adapco

Most interesting:
Sato et al. (2010). FLUENT.  0, 3, and 5 mm bypass gap width
Tak et al. (2008). CFX 11, ANSYS Inc. (2006). 1 and 5 mm bypass gap width
Wang et al. (2014). STAR-CCM+. Bypass and cross-flow estimation.

Important conclusions:
- Without whole-core modeling, computed individual mass flow distributions for partial assembly cases were based on average core assembly flow rates instead of their exact values.
This leads to under predicted fuel temperatures for the particular assemblies that had lower flow rates than the average.
- Assuming flat power profiles for all core assembly leads to lower computed assembly temperatures.
- Disagreement on which turbulence models and CFD methods are more suitable for HTGRs.
	- Sato et al 2010 and Tak et al 2008 used standard k-epsiolon model
	- Johnson 2008 determined that such model does not predicts unsteady vortex shedding correctly and suggest using the Reynolds stress model RSM instead.
	- CFD modeling differences yield differences in peak fuel temperatures by as much as 100C.
- CFD calculations require a minimum number of computational cells to model a single assembly of 2x10^6 for a 3D calculation.
Extrapolating to a whole core calculation, the mesh would need at least 85 million cells.
Hence, the method is not practical for commercial reactor safety analysis.

Unit Cell and Non-CFD Core thermal hydraulic analyses:

The NGNP point design considers both the pebble bed and prismatic type VHTR designs.
The goal of the analysis was to perform parametric sensitivity studies to establish an analytical starting point for future evaluations by quantifying the impact of variations to key design parameters such as core power, power density, assembly geometry, fuel configuration and
others.
The parametric studies investigated the impact of bypass flow, flow distribution, and total reactor power.
Some recomendations of such study are to switch to annlar fuel compacts to reduce the compact thermal resistance, reduce the gap space between the compact and graphite block, reduce the diameter of the compacts while increasing the number of compacts per assembly.

One other design study was performed by Damian 2008
Damian, 2008 % damian_vhtr_2008
Thermal hydraulic and neutronic trade-off studies were performed using the 3D thermal hydraulic code CAST3M and neutronics calculation scheme NEPHTIS
Cavalier et al. 2006
Detailed thermal calculations on a hot spot assembly
Parametric studies to reduce the max fuel temperature:
Most effective approach to reduce the radial peaking factor
Fuel burnup, fuel loading, and enrichment options analyzed

LOFC analyses:
- NGNP point design MacDonald 2003
- MHTGR case Williams et al. 1989
Williams et al. 1989
ORNL Code MORECA
- GTHTR-300 Sato et al. 2013
Sato et al. 2013
RELAP5-3D wit Point Reactor Kinetics Model
- AREVA SC-HTGR Lommers et al. 2014
Star-CD poros media based solver

If the RCCS does not operate normally temperatures might raise beyond the design limits.
Some alternatives are adding an insulation layer.
However such approach would increase fuel temperatures.

Fine mesh CFD methods are not equipped to simulate the whole core and primary system over the course of a long transient (100+ hours), and  realistic power profiles have not been fully employed in the various LOFC safety studies

% tak_practical_2012
Local analyses widely used by modeling a unit cell or single assembly instead of a whole-core geometry.
In spite of the recent rapid development of the computational fluid dynamics (CFD) technology, a whole-core CFD analysis for a prismatic reactor still requires tremendous computational expense.
This paper presents a practical method for the whole-core thermal analysis of a prismatic gas-cooled reactor.

3D heat conduction equation for a solid as in a CFD code.
1D conservation equations adopted for a fluid as in a system code.
Significant computational expense reduction.
The method adopts the basic unit cell concept which eliminates an elaborate grid generation process.

Because of the complex geometry of the HTGR, local analyses have been widely used for thermal analysis and design.
The most popular approach is the unit cell method.
6-12:

The unit cell model ignores the heat transfer within the fuel block.
- Cioni et al. 2006. CFD analysis of one fuel assembly surrounded by six half-fuel assemblies.
They focused on the ability of the coolant to cool down the fuel under blockages of different fuel channels.
- Tak et al 2008. CFD analysis of 1/12 of the fuel assembly
- Sato et al. 2010
- Kim et al. analyzed the 1/2 section of a single control fuel assembly

- Simoneau et al 2005 CFD of an entire reactor (30 deg). The fuel blocks were homogenized into triangular posts.
- Tochio and Nakagawa performed CFD analysis for the 1/6 of a 30 MW HTTR in 2005
- Pointer and Thomas 2010. 1/6 of the reactor using CFD. Internal structures of the reactor core, fuel, control fuel, and reflector blocks as well as bypass flow gaps were precisely modeled.

Whole core models are desirable for transient analyses.
Coupled analysis require full core models.

Alternative method to whole core analysis:
- system calculation: however the accuracy of the fuel block temperatures is sacrificed because of the simplification of the geometries.
3D in solids and 1D in coolant:
13,21
In a prismatic fuel block, the geometry of a solid is very complex whereas the geometry of the fluid channel is simple.
Uses finite volumes and unit cells.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%

https://www.researchgate.net/scientific-contributions/82618217_Nam-il_Tak

%%%%%%%%%%%%%%%%%%%% Multi physics maybe %%%%%%%%%%%%%%%%%%%%

% damian_vhtr_2008

%%%%%%%%%%%%%%%%%%%% Mechanics maybe %%%%%%%%%%%%%%%%%%%%

% kang_thermo-mechanical_2012