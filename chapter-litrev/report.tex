\documentclass[11pt,letterpaper]{article}

\addtolength{\oddsidemargin}{-.875in}
\addtolength{\evensidemargin}{-.875in}
\addtolength{\textwidth}{1.75in}

\addtolength{\topmargin}{-.875in}
\addtolength{\textheight}{1.75in}

\usepackage[utf8]{inputenc}
\usepackage{caption} % for table captions
\usepackage{amsmath} % for multi-line equations and piecewises
\DeclareMathOperator{\sign}{sign}
\usepackage{graphicx}
\usepackage{relsize}
\usepackage{xspace}
\usepackage{verbatim} % for block comments
\usepackage{subcaption} % for subfigures
\usepackage{enumitem} % for a) b) c) lists
\newcommand{\Cyclus}{\textsc{Cyclus}\xspace}%
\newcommand{\Cycamore}{\textsc{Cycamore}\xspace}%
\newcommand{\deploy}{\texttt{d3ploy}\xspace}%
\newcommand{\Deploy}{\texttt{D3ploy}\xspace}%
\usepackage{tabularx}
\usepackage{color}
\usepackage{multirow}
\usepackage{float}
\usepackage[acronym,toc]{glossaries}
\include{acros}
\definecolor{bg}{rgb}{0.95,0.95,0.95}
\newcolumntype{b}{X}
\newcolumntype{f}{>{\hsize=.15\hsize}X}
\newcolumntype{s}{>{\hsize=.5\hsize}X}
\newcolumntype{m}{>{\hsize=.75\hsize}X}
\newcolumntype{r}{>{\hsize=1.1\hsize}X}
\usepackage{titling}
\usepackage[hang,flushmargin]{footmisc}
\renewcommand*\footnoterule{}
\usepackage{tikz}
\usepackage{array}
\usepackage{booktabs,mathptmx,siunitx}
\sisetup{input-symbols = {()},  % do not treat "(" and ")" in any special way
         group-digits  = false} % no grouping of digits

\usetikzlibrary{shapes.geometric,arrows}
\tikzstyle{process} = [rectangle, rounded corners,
minimum width=1cm, minimum height=1cm,text centered, draw=black,
fill=blue!30]
\tikzstyle{arrow} = [thick,->,>=stealth]

\graphicspath{}

\begin{document}

\section{\gls{PMR} neutronic solvers}

Nowadays there are several codes to solve the neutronics of \glspl{PMR}.
Most of them rely on the following methods: Monte Carlo, deterministic transport, and deterministic diffusion.
We focus our interest in the last method.
% Why? Deterministic diffusion solvers have lower computational requirements than other methods reference ??
% The utilization of the Monte Carlo codes is unattractive because of the tremendous problem size and the need for a large number of neutron histories \cite{lee_status_2006}.
% It is one of the simplest means to solve neutron transport problems \cite{leppanen_development_2007}.
% Here I say the following
% The neutron diffusion equation is one of the simplest means to solve neutron transport problems \cite{leppanen_development_2007}.
% Deterministic diffusion methods are computationally cheaper than the other methods.
% This characteristic makes it a good candidate for coupled calculations.

The history of deterministic diffusion solvers begins in the late 1950s with the \gls{FDM} applied to the analysis of \glspl{LWR}.
In \gls{FDM}, mesh spacings are usually of the order of the diffusion length.
When solving large multi-dimensional problems, this feature causes the mesh points to reach intractable numbers \cite{lewis_finite_1986}.
The computational expense of these calculations motivated the generation of more computationally efficient techniques \cite{lawrence_progress_1986}.
Although there are substantial overlaps, the most common techniques fall into two broad categories: nodal methods and \gls{FEM}.

% NODAL
FLARE \cite{delp_flare_1964} is a three-dimensional boiling water reactor simulator and it is representative of the first generation of nodal schemes.
Such approach involved using adjusted parameters to match actual operating data or the results of more accurate calculations. 
Most of these methods implement the so-called 1.5 group theory.

A second generation of nodal schemes derives spatial coupling relationships by applying the \gls{TIP}.
Integrating the multi-dimensional diffusion equation over directions transverse to each coordinate axis, such procedure obtains equivalent one-dimensional equations \cite{lawrence_progress_1986}.
This approach proved to be highly efficient and accurate in Cartesian geometries.

In 1981, a formulation based on the \gls{NEM} first demonstrated the feasibility of nodal methods in hexagonal geometries \cite{duracz_nodal_1981}.
Nevertheless, this method would introduce non-physical singular terms that required the utilization of discontinuous polynomials.
This motivated the development of more effective formulations.
The code HEXNOD, introduced in 1988 \cite{wagner_three-dimensional_1989}, is an example of such formulations.
This algorithm uses the \gls{TIP} and, in contrast to the \gls{NEM}, solves the resulting differential equation analytically.
The article demonstrates the accuracy of the method by comparison with the \gls{FDM} and Monte Carlo calculations for a number of benchmark problems.

Another example of more effective methods is the code HEXPEDITE \cite{fitzpatrick_hexpedite_1992}.
The HEXPEDITE approach uses the \gls{TIP} to derive a pseudo-one-dimensional equation.
The resulting differential equation is solved analytically.
The difference from HEXNOD is that, HEXPEDITE uses a global coupling solution scheme different that is simpler and more efficient.
Different works \cite{fitzpatrick_hexpedite_1992}\cite{fitzpatrick_developments_1995} on the HEXPEDITE methodology tested the approach against the \gls{NEM} and the \gls{FDM}.
These studies established HEXPEDITEâ€™s superiority in terms of accuracy and runtime.
HEXPEDITE's use still prevailed until recently in the analysis of \glspl{HTGR}.
INL conducted a study \cite{ortensi_deterministic_2010-1} where they compared HEXPEDITE's results against other diffusion codes: JAR, CITATION, and CRONOS2, and the Monte Carlo codes MCNP5 and Serpent.

Other examples of nodal diffusion codes whose use prevailed until the present are DIF3D \cite{lawrence_dif3d_1983} and PARCS \cite{downar_parcs_2004}.
DIF3D has several solution options such as the diffusion \gls{FDM}, diffusion \gls{NEM} based on \gls{TIP}, and the VARIANT nodal transport method.
% VARIANT: variational nodal \cite{palmiotti_variant_1995}
PARCS has several solution options as well, such as a diffusion \gls{FDM}, diffusion \gls{NEM} based on \gls{TIP}, P$_{N}$ transport methods, and the multigroup transport Simplified P$_3$ with \gls{FDM} and \gls{NEM} discretizations.

% from ortensi_deterministic_2010-1 and wang_modified_2018
Nodal methods solve quite coarse meshes for approximate solutions.
This characteristic makes the method efficient.
On the other hand, the method does not provide detailed point-wise accurate solutions \cite{kang_finite_1973}.
Additionally, the application to complex problems is not flexible as different geometries require the integration over different coordinate systems.
Nodal methods are applicable for the nodes of a specific shape on which the nodal method was derived.
This lack of flexibility limits the applications of nodal methods to regular geometries only.

% FEM
The \gls{FEM} is a well-established method in applied mathematics and engineering.
Most applications make \gls{FEM} preferable due to its flexibility in the treatment of curved or irregular geometries.
Also, the use of high order elements attains higher rates of convergence \cite{cavdar_finite_2004}.
The first prototype engineering application of \gls{FEM} was in the field of structural engineering and dates back to 1956.
In the successive years, \gls{FEM} became the most extensively used technique in almost every branch of engineering.
\glspl{FEM} have several advantages over the nodal methods.
It provides flexibility in geometry, a firm mathematical basis, ease in extension to multi-group application, and high computational efficiency \cite{lee_development_2008}.

In 1973, an article by Kang \cite{kang_finite_1973} described the first application of \gls{FEM} to the neutron diffusion theory.
The main motivation for this development was the impractical application of the \gls{FDM} to three-dimensional problems.
In this early work, the author compares different \gls{FEM} approaches to the \gls{FDM} in one-dimensional and two-dimensional problems.
The studies showed a higher order of convergence achieved by the \gls{FEM}.



--------> Left here
how to continue?
Throughout the last four decades many codes have use the \gls{FEM} to solve the diffusion equation.
Some of those codes are:
* CAPP \cite{lee_development_2011}
* Rattlesnake \cite{wang_rattlesnake_2019}
* INSTANT-P1 ???



%CAPP
\gls{KAERI} developed CAPP \cite{lee_development_2008}, a neutron diffusion code based on the \gls{FEM}.
The code's purposes are to conduct steady state core physics analysis, core depletion analysis, and core transient analysis of \glspl{HTGR}.
The article validated the code with two benchmark problems.
First, the IAEA PWR benchmark problem for two cases, a 2D exercise and a 3D exercise.
Second, the OECD/NEA PBMR-400 benchmark problem.
The authors carried out Phase I Exercise 1 which consists of a neutronics stand-alone case with fixed cross-sections.
The calculations of both problems used different number of elements and different orders of shape functions.
The solutions converged to the reference solution as the number of elements or the order of shape functions increased.
The higher order \gls{FEM} solution required much less CPU time than the other methods.



--------> Left here





%\cite{lee_development_2011}




% tak_cappgamma_2016




% yuk_time-dependent_2020
A recent article by Yuk et al. \cite{yuk_time-dependent_2020} added the capability to conduct transient analyses to the reactor physics code CAPP \cite{lee_development_2011}.
This capability solves the time dependent neutron diffusion equation with the \gls{FEM}.
The main motivation behind this feature is to enable the code to conduct reactivity insertion accidents.
To take into account the thermal feedback, the authors developed a simplified thermal fluid analysis tool.
Additionally, the article introduces a new method to resolve the control rod cusping effect \cite{joo_resolution_1984}.
% The thermal calculations consider a fuel assembly divided into six triangular prisms.
% Each triangular prism has one representative coolant channel.
% After calculating the coolant temperature, a two-dimensional model calculates the temperature in the fuel and the moderator.
% The model makes the assumption that all the energy produced in each prism contributes to the temperature rise of the coolant.
% The CAPP code uses predetermined 2-D tables of thermal conductivity for each material.
% For a given fast neutron fluence and temperature, the code obtains the thermal conductivity by interpolation.
% Cross sections generated by DeCART2D.
% The authors recommend homogenizing the group constants using at least 10 energy groups.
Such method integrates over partially rodded computation nodes and they called it iPRN.
To test its accuracy, the authors conducted two exercises with several methods that reduce or remove the rod cusping effect.
The authors use the mesh reconstruction method to obtain the reference results, as such method eliminates the rod cusping effect by updating the mesh at every time step.
The iPRN method showed a higher accuracy than the other methods.
To test the new transient capabilities, they analyzed two control rod ejection scenarios.
They compared the results to those of the CAPP/GAMMA+ coupled code.
Both methods show similar results.




--------> Left here





Some examples of current \gls{FEM} diffusion solvers are Rattlesnake \cite{wang_rattlesnake_2019} and CAPP \cite{lee_development_2011}.
Also INSTANT-P1




% Number of energy groups impact over the calculations
\gls{HTGR} analyses require more energy groups than conventional \gls{LWR} analysis.
The spectral interactions between elements are significant due to a longer neutron mean free path.
\gls{ANL} directed a study \cite{lee_status_2006} to compare the accuracy of whole-core calculations versus the number of energy groups employed for generating homogenized cross-sections.
The codes used in such study were DRAGON for the cross-section homogenization and DIF3D for the whole-core calculations.
For the study, they implemented a one-dimensional fuel-reflector model in which they changed the number of energy groups from 4 to 23 groups.
They generated all the cross-sections at 300 K.
One of the conclusions is that the number of energy groups should be more than 4, and 7 or more would be sufficient for uranium fueled \glspl{HTGR}.
Another conclusion is that the accuracy is sensitive to the energy group boundaries as well.









\section{Thermo-Hydraulics}

\section{Multi-physics}
% HTGR benchmarks

Historically, linking a stand-alone neutronics solver to a thermal-hydraulics solver allowed for the simulation of an entire reactor.
For example, coupling PARCS, DIREKT, and THERMIX \cite{seker_analysis_2006} allowed for solving a \gls{PBMR}-400 Benchmark \cite{reitsma_oecdneansc_2006}.

RattleS$_n$ake \cite{wang_nonlinear_2013} has become the primary tool for solving the linearized Boltzmann neutron transport equation within \gls{MOOSE} \cite{strydom_inl_2013}.
RattleS$_n$ake counts with a variety of solvers available including low-order multigroup diffusion.
Pronghorn \cite{bingham_pronghorn_2012} \cite{novak_pronghorn_2018} is a \gls{FEM} porous media thermal-hydraulics simulation code built on the \gls{MOOSE} framework.

% More on Benchmarks
OECD PBMR400 Coupled Code Benchmark % ref ?
OECD/NEA MHTGR-350 Benchmark % ref ?
CRP on Uncertainty Analysis in HTRs % ref ?
\cite{gougar_htgr_2016}


\pagebreak
\bibliographystyle{plain}
\bibliography{bibliography}

\end{document}

	% \begin{figure}[htbp!]
	% 	\centering
	% 	\begin{subfigure}[t]{0.4\textwidth}
	% 		\centering
	% 		\includegraphics[width=\linewidth]{figures/radial-layout.png}
	% 		\caption{XY-plane.}
	% 	\end{subfigure}
	% 	\begin{subfigure}[t]{0.4\textwidth}
	% 		\centering
	% 		\includegraphics[width=\linewidth]{figures/axial-layout.png}
	% 		\caption{YZ-plane.}
	% 	\end{subfigure}
	% 	\hfill
	% 	\caption{MHTGR reactor layout.}
	% 	\label{fig:layout}
	% \end{figure}

	% \begin{figure}[htbp!]
	% 	\centering
	% 	\includegraphics[width=0.6\linewidth]{figures/axial1.png}
	% 	\hfill
	% 	\caption{Neutron flux on the specified fuel channel.}
	% 	\label{fig:axial}
	% \end{figure}
